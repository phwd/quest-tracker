package com.oculus.auth.service;

import X.AbstractC06640p5;
import X.AnonymousClass0J2;
import X.AnonymousClass0NO;
import X.AnonymousClass0QC;
import X.AnonymousClass0p1;
import X.AnonymousClass117;
import X.C003008y;
import X.C01020Iw;
import X.C02790bO;
import X.C02870bf;
import android.content.Context;
import android.os.UserHandle;
import android.text.TextUtils;
import com.facebook.ultralight.AutoGeneratedAccessMethod;
import com.facebook.ultralight.AutoGeneratedFactoryMethod;
import com.facebook.ultralight.Dependencies;
import com.facebook.ultralight.Eager;
import com.facebook.ultralight.Inject;
import com.oculus.appmanager.verifier.TrustedAppVerifier;
import com.oculus.debug.DebugMode;
import com.oculus.horizon.notifications.legacy.contract.NotificationsContract;
import com.oculus.util.constants.OculusConstants;
import javax.annotation.Nullable;
import javax.inject.Provider;

@Dependencies({"_UL__ULSEP_android_content_Context_ULSEP_com_facebook_inject_ForAppContext_ULSEP_BINDING_ID", "_UL__ULSEP_com_oculus_debug_DebugMode_ULSEP_BINDING_ID", "_UL__ULSEP_com_facebook_secure_trustedapp_TrustedApp_ULSEP_com_oculus_auth_service_ForAuthModule_ULSEP_BINDING_ID", "_UL__ULSEP_com_oculus_appmanager_verifier_TrustedAppVerifier_ULSEP_BINDING_ID", "_UL__ULSEP_com_oculus_android_os_internal_UserHandleInternal_ULSEP_BINDING_ID"})
public class AuthTrustedAppVerifier {
    public static final String TAG = "AuthTrustedAppVerifier";
    public AnonymousClass0QC _UL_mInjectionContext;
    @Inject
    @Eager
    public final DebugMode mDebugMode;
    public final String mSelfPackageName = ((Context) AnonymousClass0J2.A03(0, 294, this._UL_mInjectionContext)).getApplicationInfo().packageName;
    @Inject
    @ForAuthModule
    @Eager
    public final C02870bf mTrustedApp;
    @Inject
    @Eager
    public final TrustedAppVerifier mTrustedAppVerifier;

    public boolean isTrusted(@Nullable C02790bO r9) {
        String str;
        String str2;
        if (r9 == null) {
            str = TAG;
            str2 = "Untrusted apps since it is missing caller info";
        } else {
            int i = r9.A00;
            if (UserHandle.getAppId(i) != 1000) {
                String A01 = r9.A01();
                if (!this.mSelfPackageName.equals(A01)) {
                    if ("com.oculus.companion.server".equals(A01) || "com.oculus.unifiedtelemetry".equals(A01) || OculusConstants.PACKAGE_NAME_APP_SAFETY.equals(A01) || OculusConstants.PACKAGE_NAME_ARIANE_UPLOAD.equals(A01)) {
                        boolean A00 = TrustedAppVerifier.A00(this.mTrustedAppVerifier, A01, OculusConstants.PACKAGE_NAME_APP_SAFETY);
                        boolean A002 = TrustedAppVerifier.A00(this.mTrustedAppVerifier, A01, "com.oculus.companion.server");
                        boolean A003 = TrustedAppVerifier.A00(this.mTrustedAppVerifier, A01, "com.oculus.unifiedtelemetry");
                        boolean z = true;
                        if (!TextUtils.equals(A01, OculusConstants.PACKAGE_NAME_ARIANE_UPLOAD)) {
                            z = false;
                        }
                        if (!A00 && !A002 && !A003 && !z) {
                            str = TAG;
                            str2 = "Untrusted app. since CompanionServer | UnifiedTelemetry have to be system apps";
                        }
                    } else {
                        C02870bf r2 = this.mTrustedApp;
                        Context context = (Context) AnonymousClass0J2.A03(0, 294, this._UL_mInjectionContext);
                        return r2.A07(C02870bf.A00(i, context), context);
                    }
                }
            }
            return true;
        }
        AnonymousClass0NO.A08(str, str2);
        return false;
    }

    @AutoGeneratedAccessMethod
    public static final AnonymousClass0p1 _UL__ULSEP_com_facebook_inject_Lazy_ULLT_com_oculus_auth_service_AuthTrustedAppVerifier_ULGT__ULSEP_ACCESS_METHOD(AbstractC06640p5 r2) {
        return new C003008y(NotificationsContract.GENERIC_NOTIFICATION_ID, r2);
    }

    @AutoGeneratedAccessMethod
    public static final AuthTrustedAppVerifier _UL__ULSEP_com_oculus_auth_service_AuthTrustedAppVerifier_ULSEP_ACCESS_METHOD(AbstractC06640p5 r1) {
        return (AuthTrustedAppVerifier) AnonymousClass117.A00(NotificationsContract.GENERIC_NOTIFICATION_ID, r1);
    }

    @AutoGeneratedFactoryMethod
    public static final AuthTrustedAppVerifier _UL__ULSEP_com_oculus_auth_service_AuthTrustedAppVerifier_ULSEP_FACTORY_METHOD(AbstractC06640p5 r1) {
        return new AuthTrustedAppVerifier(r1);
    }

    @AutoGeneratedAccessMethod
    public static final Provider _UL__ULSEP_javax_inject_Provider_ULLT_com_oculus_auth_service_AuthTrustedAppVerifier_ULGT__ULSEP_ACCESS_METHOD(AbstractC06640p5 r2) {
        return new C01020Iw(NotificationsContract.GENERIC_NOTIFICATION_ID, r2);
    }

    @Inject
    public AuthTrustedAppVerifier(AbstractC06640p5 r4) {
        this._UL_mInjectionContext = new AnonymousClass0QC(2, r4);
        this.mDebugMode = DebugMode.A00(r4);
        this.mTrustedApp = AuthModule._UL__ULSEP_com_facebook_secure_trustedapp_TrustedApp_ULSEP_com_oculus_auth_service_ForAuthModule_ULSEP_ACCESS_METHOD(r4);
        this.mTrustedAppVerifier = (TrustedAppVerifier) AnonymousClass117.A00(501, r4);
    }
}
