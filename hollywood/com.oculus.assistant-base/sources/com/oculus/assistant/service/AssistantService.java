package com.oculus.assistant.service;

import X.A4;
import X.AX;
import X.AbstractC00889s;
import X.AbstractC0105Aj;
import X.AbstractC0447Yr;
import X.AnonymousClass08;
import X.AnonymousClass09;
import X.AnonymousClass3G;
import X.AnonymousClass3H;
import X.AnonymousClass3I;
import X.AnonymousClass3J;
import X.AnonymousClass3K;
import X.AnonymousClass3L;
import X.AnonymousClass3M;
import X.AnonymousClass3P;
import X.AnonymousClass3Q;
import X.AnonymousClass3R;
import X.AnonymousClass3T;
import X.AnonymousClass3Y;
import X.AnonymousClass3z;
import X.AnonymousClass41;
import X.AnonymousClass42;
import X.AnonymousClass6A;
import X.AnonymousClass6B;
import X.AnonymousClass6X;
import X.AnonymousClass6g;
import X.AnonymousClass7q;
import X.AnonymousClass8E;
import X.AnonymousClass8I;
import X.AnonymousClass8J;
import X.AnonymousClass8P;
import X.AnonymousClass8R;
import X.AnonymousClass8T;
import X.BJ;
import X.BM;
import X.BX;
import X.Bc;
import X.Bd;
import X.C00233b;
import X.C00243c;
import X.C00253d;
import X.C00263e;
import X.C00333y;
import X.C00366h;
import X.C00426r;
import X.C00456u;
import X.C00476w;
import X.C00608k;
import X.C00618l;
import X.C00648r;
import X.C00799i;
import X.C00829m;
import X.C0112Aq;
import X.C0139Dd;
import X.C0149Dq;
import X.C0200Jn;
import X.C0398Vv;
import X.C0403Wf;
import X.C0408Wk;
import X.C0434Xm;
import X.C0446Yq;
import X.C0514bB;
import X.C0647dr;
import X.C0648ds;
import X.C0740gP;
import X.C0771gx;
import X.C0772gy;
import X.C0774h0;
import X.C0775h2;
import X.C0776h5;
import X.C0787ha;
import X.C0789hc;
import X.C0799hn;
import X.C0800ho;
import X.C0801hp;
import X.C0802hq;
import X.C0803hr;
import X.C0805ht;
import X.C0806hu;
import X.C0807hv;
import X.C0808hw;
import X.C0809hx;
import X.C0811hz;
import X.C0824iU;
import X.C1202vH;
import X.C1203vI;
import X.C1204vJ;
import X.C1209vO;
import X.C1210vP;
import X.C1213vT;
import X.C1220va;
import X.C1222vc;
import X.C1223vd;
import X.C1224ve;
import X.C1254wA;
import X.C1255wB;
import X.C1256wC;
import X.C1257wD;
import X.C1258wE;
import X.C1259wF;
import X.C1260wG;
import X.C1261wH;
import X.C1262wI;
import X.C1284we;
import X.C1286wg;
import X.C1293wn;
import X.C1294wo;
import X.C1300wu;
import X.C1310x4;
import X.C1311x5;
import X.C1312x6;
import X.C1313x7;
import X.C1314x8;
import X.C1315x9;
import X.C1316xA;
import X.C1317xB;
import X.C1318xC;
import X.C1319xD;
import X.C1320xE;
import X.C1322xG;
import X.C1323xH;
import X.C1324xI;
import X.C1325xJ;
import X.C1326xK;
import X.C1327xL;
import X.C1329xN;
import X.C1330xO;
import X.C1331xP;
import X.C1332xQ;
import X.C1333xR;
import X.C1334xS;
import X.C1335xT;
import X.C1336xU;
import X.C1337xV;
import X.C1338xW;
import X.C1339xX;
import X.C1340xY;
import X.C1341xZ;
import X.C1342xa;
import X.C1343xb;
import X.C1345xd;
import X.C1346xe;
import X.C1347xf;
import X.C1348xg;
import X.C1349xh;
import X.C1350xi;
import X.C1351xj;
import X.C1352xk;
import X.C1353xl;
import X.C1375yA;
import X.C1376yB;
import X.C1382yJ;
import X.C1383yK;
import X.C1396yX;
import X.C1398yc;
import X.C1399yd;
import X.C1404yq;
import X.C1407yt;
import X.C1412yy;
import X.C1413yz;
import X.C1417z8;
import X.C1418zA;
import X.C1423zG;
import X.HandlerC0422Wz;
import X.KJ;
import X.RunnableC0423Xa;
import X.RunnableC0424Xb;
import X.W0;
import X.W9;
import X.WV;
import X.X0;
import X.X7;
import X.XK;
import X.XL;
import X.XM;
import X.XN;
import X.XO;
import X.XP;
import X.XQ;
import X.XR;
import X.XT;
import X.XU;
import X.XV;
import X.XW;
import X.XX;
import X.XY;
import X.Y0;
import X.Y2;
import X.Y4;
import X.Y5;
import X.Y7;
import X.YB;
import X.YJ;
import X.YM;
import X.YN;
import X.YO;
import X.YP;
import X.YQ;
import X.YR;
import X.YS;
import X.Z4;
import X.h4;
import X.hN;
import X.hO;
import X.hS;
import X.hT;
import X.hU;
import X.hX;
import X.hY;
import X.hZ;
import X.i0;
import X.i1;
import X.i3;
import X.iF;
import X.l0;
import X.vR;
import X.w1;
import X.yZ;
import X.z6;
import X.z7;
import X.z9;
import android.app.ActivityManager;
import android.app.Application;
import android.app.KeyguardManager;
import android.app.Notification;
import android.app.NotificationChannel;
import android.app.NotificationManager;
import android.app.Service;
import android.content.BroadcastReceiver;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.SharedPreferences;
import android.content.pm.PackageManager;
import android.os.Binder;
import android.os.Build;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.os.Environment;
import android.os.Handler;
import android.os.HandlerThread;
import android.os.IBinder;
import android.os.IInterface;
import android.os.Parcel;
import android.os.PowerManager;
import android.os.Process;
import android.os.SystemClock;
import android.preference.PreferenceManager;
import android.text.TextUtils;
import com.facebook.acra.AppComponentStats;
import com.facebook.acra.ErrorReporter;
import com.facebook.assistant.clientplatform.logger.AssistantLogger;
import com.facebook.assistant.oacr.OacrConstants;
import com.facebook.debug.tracer.Tracer;
import com.oculus.assistant.R;
import com.oculus.assistant.assistantutils.SystemUXUtil;
import com.oculus.assistant.config.AssistantDeviceSettings;
import com.oculus.assistant.entry.AssistantEntryManager;
import com.oculus.assistant.panel.VoiceSelectionDialog;
import com.oculus.assistant.service.api.IOculusAssistantService;
import com.oculus.assistant.service.api.attention.AssistantErrorType;
import com.oculus.assistant.service.api.attention.AssistantInteractionState;
import com.oculus.assistant.service.api.attention.IOculusAssistantAttentionListener;
import com.oculus.assistant.service.api.attention.IOculusAssistantAttentionService;
import com.oculus.assistant.service.api.control.IOculusAssistantControlService;
import com.oculus.assistant.service.api.control.IOculusAssistantControlService$Stub$Proxy;
import com.oculus.assistant.service.api.remoteaudiosource.IRemoteAudioSource;
import com.oculus.assistant.service.api.remoteaudiosource.IRemoteAudioSource$Stub$Proxy;
import com.oculus.assistant.service.api.transcription.IOculusAssistantTranscriptionService;
import com.oculus.assistant.service.api.transcription.IOculusAssistantTranscriptionService$Stub$Proxy;
import com.oculus.assistant.service.typeahead.OculusTypeaheadProvider;
import com.oculus.os.SettingsManager;
import com.oculus.os.SettingsObserverCallback;
import com.oculus.os.Version;
import com.oculus.os.VoiceAssistantManager;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.UUID;
import java.util.concurrent.CopyOnWriteArrayList;
import java.util.concurrent.atomic.AtomicBoolean;

public class AssistantService extends Service {
    public static AssistantService A1N;
    public int A00;
    public long A01;
    public long A02;
    public long A03;
    public CountDownTimer A04;
    public C0740gP A05;
    public AnonymousClass8P A06 = new AnonymousClass8P();
    public AbstractC0105Aj A07;
    public AbstractC0105Aj A08;
    public AbstractC0105Aj A09;
    public AbstractC0105Aj A0A;
    public AbstractC0105Aj A0B;
    public AbstractC0105Aj A0C;
    public AbstractC0105Aj A0D;
    public AbstractC0105Aj A0E;
    public AbstractC0105Aj A0F;
    public AbstractC0105Aj A0G;
    public AbstractC0105Aj A0H;
    public AbstractC0105Aj A0I;
    public AbstractC0105Aj A0J;
    public AbstractC0105Aj A0K;
    public AbstractC0105Aj A0L;
    public AbstractC0105Aj A0M;
    public AbstractC0105Aj A0N;
    public AbstractC0105Aj A0O;
    public AbstractC0105Aj A0P;
    public w1 A0Q;
    public C0403Wf A0R;
    public VoiceSelectionDialog A0S;
    public StartReason A0T = StartReason.UNKNOWN;
    public Y0 A0U;
    public C1375yA A0V;
    public C1376yB A0W;
    public Y4 A0X;
    public YB A0Y;
    public C1383yK A0Z;
    public YP A0a;
    public AssistantInteractionState A0b;
    public C1412yy A0c = new C1412yy();
    public C1413yz A0d;
    public SettingsManager A0e;
    public String A0f;
    public String A0g;
    public String A0h;
    public boolean A0i;
    public boolean A0j;
    public boolean A0k;
    public boolean A0l;
    public boolean A0m;
    public boolean A0n;
    public boolean A0o;
    public long A0p;
    public KeyguardManager A0q;
    public Handler A0r;
    public HandlerThread A0s;
    public AssistantEntryManager A0t;
    public C0434Xm A0u;
    public Y2 A0v;
    public Y7 A0w;
    public YJ A0x;
    public YM A0y;
    public OculusTypeaheadProvider A0z;
    public VoiceAssistantManager A10;
    public boolean A11;
    public boolean A12;
    public boolean A13;
    public final AbstractC0105Aj A14;
    public final AbstractC0105Aj A15;
    public final AbstractC0105Aj A16;
    public final AbstractC0105Aj A17;
    public final C0112Aq A18;
    public final AnonymousClass4 A19;
    public final AnonymousClass5 A1A;
    public final AttentionBinder A1B;
    public final SafeInitializationManager A1C = new SafeInitializationManager();
    public final SafeInitializationManager A1D = new SafeInitializationManager();
    public final SafeInitializationManager A1E = new SafeInitializationManager();
    public final SafeInitializationManager A1F = new SafeInitializationManager();
    public final AtomicBoolean A1G = new AtomicBoolean(false);
    public final BroadcastReceiver A1H;
    public final BroadcastReceiver A1I;
    public final BroadcastReceiver A1J = new X7() {
        /* class com.oculus.assistant.service.AssistantService.AnonymousClass1 */

        @Override // X.X7
        public void onSurfaceCloseEvent(String str, String str2, String str3, String str4) {
            super.onSurfaceCloseEvent(str, str2, str3, str4);
            if (str2 != null) {
                AssistantLogger assistantLogger = C00799i.A00;
                assistantLogger.logServiceEvent(AnonymousClass08.A06("dialog_closed_event::", str2, "::", str4));
                if (str2.equals("dlg-enable-keyboard-fl")) {
                    assistantLogger.logNuxEvent("KeyboardFederatedLearningDialog: Closed");
                }
            }
        }
    };
    public final HandlerC0422Wz A1K;
    public final AssistantBinder A1L;
    public final SettingsObserverCallback A1M;

    /* renamed from: com.oculus.assistant.service.AssistantService$11  reason: invalid class name */
    public /* synthetic */ class AnonymousClass11 {
        public static final /* synthetic */ int[] $SwitchMap$com$facebook$assistant$clientplatform$AssistantServerOverride;
        public static final /* synthetic */ int[] $SwitchMap$com$facebook$assistant$clientplatform$clientstate$AssistantSpeechState;
        public static final /* synthetic */ int[] $SwitchMap$com$oculus$assistant$service$api$attention$AssistantInteractionState;

        /* JADX WARNING: Can't wrap try/catch for region: R(17:0|1|2|3|(2:5|6)|7|9|10|11|12|13|15|16|17|18|19|(3:21|22|24)) */
        /* JADX WARNING: Failed to process nested try/catch */
        /* JADX WARNING: Missing exception handler attribute for start block: B:11:0x0023 */
        /* JADX WARNING: Missing exception handler attribute for start block: B:17:0x0037 */
        static {
            /*
                r0 = 5
                java.lang.Integer[] r0 = X.AnonymousClass09.A00(r0)
                int r0 = r0.length
                int[] r4 = new int[r0]
                com.oculus.assistant.service.AssistantService.AnonymousClass11.$SwitchMap$com$facebook$assistant$clientplatform$clientstate$AssistantSpeechState = r4
                r3 = 1
                r1 = 2
                r4[r1] = r3     // Catch:{ NoSuchFieldError -> 0x000e }
            L_0x000e:
                r2 = 2
                r0 = 3
                r4[r0] = r1     // Catch:{ NoSuchFieldError -> 0x0012 }
            L_0x0012:
                com.oculus.assistant.service.api.attention.AssistantInteractionState[] r0 = com.oculus.assistant.service.api.attention.AssistantInteractionState.values()
                int r0 = r0.length
                int[] r1 = new int[r0]
                com.oculus.assistant.service.AssistantService.AnonymousClass11.$SwitchMap$com$oculus$assistant$service$api$attention$AssistantInteractionState = r1
                com.oculus.assistant.service.api.attention.AssistantInteractionState r0 = com.oculus.assistant.service.api.attention.AssistantInteractionState.INACTIVE     // Catch:{ NoSuchFieldError -> 0x0023 }
                int r0 = r0.ordinal()     // Catch:{ NoSuchFieldError -> 0x0023 }
                r1[r0] = r3     // Catch:{ NoSuchFieldError -> 0x0023 }
            L_0x0023:
                com.oculus.assistant.service.api.attention.AssistantInteractionState r0 = com.oculus.assistant.service.api.attention.AssistantInteractionState.LISTENING     // Catch:{ NoSuchFieldError -> 0x002b }
                int r0 = r0.ordinal()     // Catch:{ NoSuchFieldError -> 0x002b }
                r1[r0] = r2     // Catch:{ NoSuchFieldError -> 0x002b }
            L_0x002b:
                r0 = 4
                java.lang.Integer[] r0 = X.AnonymousClass09.A00(r0)
                int r0 = r0.length
                int[] r1 = new int[r0]
                com.oculus.assistant.service.AssistantService.AnonymousClass11.$SwitchMap$com$facebook$assistant$clientplatform$AssistantServerOverride = r1
                r1[r3] = r3     // Catch:{ NoSuchFieldError -> 0x0037 }
            L_0x0037:
                r1[r2] = r2     // Catch:{ NoSuchFieldError -> 0x0039 }
            L_0x0039:
                r0 = 3
                r1[r0] = r0     // Catch:{ NoSuchFieldError -> 0x003c }
            L_0x003c:
                return
            */
            throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.AnonymousClass11.<clinit>():void");
        }
    }

    /* renamed from: com.oculus.assistant.service.AssistantService$4  reason: invalid class name */
    public class AnonymousClass4 extends Binder implements IOculusAssistantControlService {
        public static final String DESCRIPTOR = "com.oculus.assistant.service.api.control.IOculusAssistantControlService";
        public static final int TRANSACTION_activateAssistant = 1;
        public static final int TRANSACTION_addAudioSource = 4;
        public static final int TRANSACTION_isAutorecordingEnabled = 3;
        public static final int TRANSACTION_removeAudioSource = 5;
        public static final int TRANSACTION_stopAssistant = 2;
        public final AX mRemoteSources;

        public IBinder asBinder() {
            return this;
        }

        @Override // android.os.Binder
        public boolean onTransact(int i, Parcel parcel, Parcel parcel2, int i2) {
            IRemoteAudioSource iRemoteAudioSource$Stub$Proxy;
            if (i == 1) {
                parcel.enforceInterface(DESCRIPTOR);
                activateAssistant();
            } else if (i == 2) {
                parcel.enforceInterface(DESCRIPTOR);
                stopAssistant();
            } else if (i == 3) {
                parcel.enforceInterface(DESCRIPTOR);
                boolean isAutorecordingEnabled = isAutorecordingEnabled();
                parcel2.writeNoException();
                parcel2.writeInt(isAutorecordingEnabled ? 1 : 0);
                return true;
            } else if (i == 4) {
                parcel.enforceInterface(DESCRIPTOR);
                IBinder readStrongBinder = parcel.readStrongBinder();
                if (readStrongBinder == null) {
                    iRemoteAudioSource$Stub$Proxy = null;
                } else {
                    IInterface queryLocalInterface = readStrongBinder.queryLocalInterface("com.oculus.assistant.service.api.remoteaudiosource.IRemoteAudioSource");
                    if (queryLocalInterface == null || !(queryLocalInterface instanceof IRemoteAudioSource)) {
                        iRemoteAudioSource$Stub$Proxy = new IRemoteAudioSource$Stub$Proxy(readStrongBinder);
                    } else {
                        iRemoteAudioSource$Stub$Proxy = (IRemoteAudioSource) queryLocalInterface;
                    }
                }
                String addAudioSource = addAudioSource(iRemoteAudioSource$Stub$Proxy, parcel.readInt());
                parcel2.writeNoException();
                parcel2.writeString(addAudioSource);
                return true;
            } else if (i == 5) {
                parcel.enforceInterface(DESCRIPTOR);
                removeAudioSource(parcel.readString());
            } else if (i != 1598968902) {
                return super.onTransact(i, parcel, parcel2, i2);
            } else {
                parcel2.writeString(DESCRIPTOR);
                return true;
            }
            parcel2.writeNoException();
            return true;
        }

        public static IOculusAssistantControlService asInterface(IBinder iBinder) {
            if (iBinder == null) {
                return null;
            }
            IInterface queryLocalInterface = iBinder.queryLocalInterface(DESCRIPTOR);
            if (queryLocalInterface == null || !(queryLocalInterface instanceof IOculusAssistantControlService)) {
                return new IOculusAssistantControlService$Stub$Proxy(iBinder);
            }
            return (IOculusAssistantControlService) queryLocalInterface;
        }

        public static boolean setDefaultImpl(IOculusAssistantControlService iOculusAssistantControlService) {
            if (IOculusAssistantControlService$Stub$Proxy.A01 != null) {
                throw new IllegalStateException("setDefaultImpl() called twice");
            } else if (iOculusAssistantControlService == null) {
                return false;
            } else {
                IOculusAssistantControlService$Stub$Proxy.A01 = iOculusAssistantControlService;
                return true;
            }
        }

        public void activateAssistant() {
            AssistantService.this.A0a.A04("remote");
            AssistantService.this.A0K();
        }

        public String addAudioSource(final IRemoteAudioSource iRemoteAudioSource, int i) {
            AnonymousClass1 r4 = new AbstractC0447Yr() {
                /* class com.oculus.assistant.service.AssistantService.AnonymousClass4.AnonymousClass1 */
                public String mName;

                @Override // X.AbstractC0447Yr
                public boolean isAudioDataPcm() {
                    return true;
                }

                @Override // java.io.Closeable, java.lang.AutoCloseable, java.io.InputStream
                public void close() {
                    try {
                        iRemoteAudioSource.close();
                    } catch (Exception e) {
                        AssistantService.this.A0M(this);
                        C0139Dd.A0O("AssistantService", "Error opening source: %s", getSourceName(), e);
                    }
                }

                @Override // X.AbstractC0447Yr
                public String getSourceName() {
                    String str = this.mName;
                    if (str != null) {
                        return str;
                    }
                    try {
                        String A2v = iRemoteAudioSource.A2v();
                        this.mName = A2v;
                        return A2v;
                    } catch (Exception e) {
                        StringBuilder sb = new StringBuilder(OacrConstants.AUTO_SPEECH_DOMAIN);
                        sb.append(iRemoteAudioSource);
                        C0139Dd.A0O("AssistantService", "Error with remote source. Could not get source name from %s", sb.toString(), e);
                        AssistantService.this.A0M(this);
                        return "RemoteAudioSource";
                    }
                }

                @Override // X.AbstractC0447Yr
                public boolean isSourceAvailable() {
                    try {
                        return iRemoteAudioSource.A3b();
                    } catch (Exception unused) {
                        C0139Dd.A0D("AssistantService", AnonymousClass08.A05("Error checking source availability, assuming ", this.mName, " is no longer available. Removing it."));
                        AssistantService.this.A0M(this);
                        return false;
                    }
                }

                @Override // X.AbstractC0447Yr
                public void open() {
                    try {
                        iRemoteAudioSource.A4S();
                    } catch (Exception e) {
                        AssistantService.this.A0M(this);
                        C0139Dd.A0O("AssistantService", "Error opening remote source: %s", getSourceName(), e);
                    }
                }

                @Override // java.io.InputStream
                public int read(byte[] bArr, int i, int i2) {
                    try {
                        return iRemoteAudioSource.read(bArr, i, i2);
                    } catch (Exception e) {
                        AssistantService.this.A0M(this);
                        C0139Dd.A0O("AssistantService", "Error reading from remote source: %s", getSourceName(), e);
                        return 0;
                    }
                }

                @Override // X.AbstractC0447Yr
                public int getSampleRate() {
                    return 48000;
                }
            };
            AX ax = this.mRemoteSources;
            String obj = UUID.randomUUID().toString();
            if (obj == null) {
                String obj2 = UUID.randomUUID().toString();
                if (obj2 == null) {
                    AX.A00(ax, UUID.randomUUID().toString(), r4);
                } else {
                    ax.A01.put(obj2, r4);
                }
            } else {
                ax.A01.put(obj, r4);
            }
            AssistantService assistantService = AssistantService.this;
            C0139Dd.A0F("AssistantService", "Adding audio source: %s", r4);
            assistantService.A0d.A01(r4, i);
            AssistantService.this.A0m = true;
            return obj;
        }

        public boolean isAutorecordingEnabled() {
            return PreferenceManager.getDefaultSharedPreferences(AssistantService.this.getApplicationContext()).getBoolean("audiologging", false);
        }

        public void removeAudioSource(String str) {
            Object obj;
            AssistantService assistantService = AssistantService.this;
            AX ax = this.mRemoteSources;
            if (str != null) {
                obj = ax.A01.remove(str);
            } else {
                obj = null;
            }
            assistantService.A0M((AbstractC0447Yr) obj);
            AssistantService.this.A0m = false;
        }

        public void stopAssistant() {
            AssistantService.A06(AssistantService.this);
        }

        public static IOculusAssistantControlService getDefaultImpl() {
            return IOculusAssistantControlService$Stub$Proxy.A01;
        }

        public AnonymousClass4() {
            attachInterface(this, DESCRIPTOR);
        }

        public AnonymousClass4() {
            this();
            this.mRemoteSources = new AX();
        }
    }

    /* renamed from: com.oculus.assistant.service.AssistantService$5  reason: invalid class name */
    public class AnonymousClass5 extends Binder implements IOculusAssistantTranscriptionService {
        public static final String DESCRIPTOR = "com.oculus.assistant.service.api.transcription.IOculusAssistantTranscriptionService";
        public static final int TRANSACTION_configure = 3;
        public static final int TRANSACTION_logEvent = 4;
        public static final int TRANSACTION_startTranscriptionSession = 1;
        public static final int TRANSACTION_stopTranscriptionSession = 2;

        public IBinder asBinder() {
            return this;
        }

        public void logEvent(String str, Bundle bundle) {
            C00799i.A00.logTranscriptionAnalytics(str, new C00829m(bundle.getInt("edit_distance", 0), bundle.getInt("chars_inserted", 0), bundle.getInt("chars_deleted", 0), bundle.getInt("chars_replaced", 0)));
        }

        @Override // android.os.Binder
        public boolean onTransact(int i, Parcel parcel, Parcel parcel2, int i2) {
            if (i == 1) {
                parcel.enforceInterface(DESCRIPTOR);
                startTranscriptionSession();
            } else if (i != 2) {
                Bundle bundle = null;
                if (i == 3) {
                    parcel.enforceInterface(DESCRIPTOR);
                    if (parcel.readInt() != 0) {
                        bundle = (Bundle) Bundle.CREATOR.createFromParcel(parcel);
                    }
                    configure(bundle);
                } else if (i == 4) {
                    parcel.enforceInterface(DESCRIPTOR);
                    String readString = parcel.readString();
                    if (parcel.readInt() != 0) {
                        bundle = (Bundle) Bundle.CREATOR.createFromParcel(parcel);
                    }
                    logEvent(readString, bundle);
                } else if (i != 1598968902) {
                    return super.onTransact(i, parcel, parcel2, i2);
                } else {
                    parcel2.writeString(DESCRIPTOR);
                    return true;
                }
            } else {
                parcel.enforceInterface(DESCRIPTOR);
                stopTranscriptionSession();
            }
            parcel2.writeNoException();
            return true;
        }

        public static IOculusAssistantTranscriptionService asInterface(IBinder iBinder) {
            if (iBinder == null) {
                return null;
            }
            IInterface queryLocalInterface = iBinder.queryLocalInterface(DESCRIPTOR);
            if (queryLocalInterface == null || !(queryLocalInterface instanceof IOculusAssistantTranscriptionService)) {
                return new IOculusAssistantTranscriptionService$Stub$Proxy(iBinder);
            }
            return (IOculusAssistantTranscriptionService) queryLocalInterface;
        }

        public static boolean setDefaultImpl(IOculusAssistantTranscriptionService iOculusAssistantTranscriptionService) {
            if (IOculusAssistantTranscriptionService$Stub$Proxy.A01 != null) {
                throw new IllegalStateException("setDefaultImpl() called twice");
            } else if (iOculusAssistantTranscriptionService == null) {
                return false;
            } else {
                IOculusAssistantTranscriptionService$Stub$Proxy.A01 = iOculusAssistantTranscriptionService;
                return true;
            }
        }

        public void configure(Bundle bundle) {
            AssistantService.this.A1E.safeExecute(new XN(this, bundle));
        }

        public /* synthetic */ void lambda$configure$3$AssistantService$5(Bundle bundle) {
            Y4 y4 = AssistantService.this.A0X;
            C0514bB.A02(bundle, "configuration");
            for (String str : bundle.keySet()) {
                if (str != null) {
                    switch (str.hashCode()) {
                        case -1837143221:
                            if (str.equals("keyboard_action_type")) {
                                y4.A02.A02 = bundle.getString(str);
                                break;
                            } else {
                                continue;
                            }
                        case -1674727137:
                            if (str.equals("disable_auto_close")) {
                                y4.A02.A07 = bundle.getBoolean(str);
                                break;
                            } else {
                                continue;
                            }
                        case -613028982:
                            if (str.equals("auto_close_timeout")) {
                                y4.A02.A01 = (long) bundle.getInt(str);
                                break;
                            } else {
                                continue;
                            }
                        case 282323375:
                            if (str.equals("customize_for_app")) {
                                y4.A02.A04 = bundle.getString(str);
                                break;
                            } else {
                                continue;
                            }
                        case 1414887911:
                            if (str.equals("keyboard_input_type")) {
                                y4.A02.A03 = bundle.getString(str);
                                break;
                            } else {
                                continue;
                            }
                        case 1951546486:
                            if (str.equals("enable_multiphrase")) {
                                y4.A02.A08 = bundle.getBoolean(str);
                                break;
                            } else {
                                continue;
                            }
                    }
                }
            }
            Y4.A00(y4);
        }

        public /* synthetic */ void lambda$startTranscriptionSession$0$AssistantService$5() {
            AssistantService.A0C(AssistantService.this, "transcription");
        }

        public /* synthetic */ void lambda$startTranscriptionSession$1$AssistantService$5() {
            AssistantService.this.A0L();
        }

        public /* synthetic */ void lambda$stopTranscriptionSession$2$AssistantService$5() {
            AssistantService.A07(AssistantService.this);
        }

        public void startTranscriptionSession() {
            AssistantService assistantService = AssistantService.this;
            assistantService.A0T = StartReason.TRANSCRIPTION;
            if (AssistantService.A0G(assistantService, "transcription") || Z4.A02()) {
                AssistantService.this.A1E.safeExecute(new XO(this));
            } else {
                AssistantService.this.A1C.safeExecute(new XM(this));
            }
        }

        public void stopTranscriptionSession() {
            AssistantService.this.A1E.safeExecute(new XL(this));
        }

        public static IOculusAssistantTranscriptionService getDefaultImpl() {
            return IOculusAssistantTranscriptionService$Stub$Proxy.A01;
        }

        public AnonymousClass5() {
            attachInterface(this, DESCRIPTOR);
        }

        public AnonymousClass5() {
            this();
        }
    }

    public class AssistantBinder extends IOculusAssistantService.Stub {
        @Override // com.oculus.assistant.service.api.IOculusAssistantService
        public IOculusAssistantAttentionService getAttentionService() {
            AssistantService.this.A0U.A00();
            return AssistantService.this.A1B;
        }

        @Override // com.oculus.assistant.service.api.IOculusAssistantService
        public IOculusAssistantControlService getControlService() {
            AssistantService.this.A0U.A00();
            return AssistantService.this.A19;
        }

        @Override // com.oculus.assistant.service.api.IOculusAssistantService
        public IOculusAssistantTranscriptionService getTranscriptionService() {
            AssistantService.this.A0U.A00();
            return AssistantService.this.A1A;
        }

        public AssistantBinder() {
        }
    }

    public class AttentionBinder extends IOculusAssistantAttentionService.Stub {
        public String onAddAttentionListener(String str, IOculusAssistantAttentionListener iOculusAssistantAttentionListener) {
            YB yb = AssistantService.this.A0Y;
            return YB.A00(yb, yb.A0A, str, iOculusAssistantAttentionListener);
        }

        public void onRemoveAttentionListener(String str) {
            AssistantService.this.A0Y.A0A.A01(str);
        }

        @Override // com.oculus.assistant.service.api.attention.IOculusAssistantAttentionService
        public final String registerAttentionListener(IOculusAssistantAttentionListener iOculusAssistantAttentionListener) {
            Application A00 = BX.A00();
            if (Binder.getCallingPid() != Process.myPid()) {
                String A002 = C0200Jn.A00(Binder.getCallingUid(), A00).A00();
                C0139Dd.A0F("AssistantService", "Registering attention listener with key: %s", A002);
                if ("com.oculus.systemux".equals(A002)) {
                    return onAddAttentionListener(A002, new SystemAttentionPrePushHandler(AssistantService.this, iOculusAssistantAttentionListener));
                }
                return onAddAttentionListener(A002, iOculusAssistantAttentionListener);
            }
            throw new IllegalStateException("This method should be called on behalf of an IPC transaction from binder thread.");
        }

        @Override // com.oculus.assistant.service.api.attention.IOculusAssistantAttentionService
        public final void removeAttentionListener(String str) {
            onRemoveAttentionListener(str);
        }

        public AttentionBinder() {
        }
    }

    public class SafeInitializationManager {
        public final Object lock;
        public final AtomicBoolean mIsReady;
        public final AtomicBoolean mIsStarted;
        public final List mPendingTasks;

        public boolean getIsStarted() {
            return this.mIsStarted.get();
        }

        public boolean isReady() {
            return this.mIsReady.get();
        }

        public void safeExecute(Runnable runnable) {
            if (!this.mIsStarted.get() && AssistantService.this.A1D.mIsReady.get() && AssistantService.this.A1C.mIsReady.get()) {
                AssistantService.A08(AssistantService.this);
            }
            if (this.mIsReady.get()) {
                runnable.run();
                return;
            }
            synchronized (this.lock) {
                this.mPendingTasks.add(runnable);
            }
        }

        public void setIsReady(boolean z) {
            ArrayList arrayList = new ArrayList();
            this.mIsReady.set(z);
            if (z) {
                synchronized (this.lock) {
                    arrayList.addAll(this.mPendingTasks);
                    this.mPendingTasks.clear();
                }
                Iterator it = arrayList.iterator();
                while (it.hasNext()) {
                    ((Runnable) it.next()).run();
                }
            }
        }

        public void setIsStarted(boolean z) {
            this.mIsStarted.set(z);
        }

        public SafeInitializationManager() {
            this.mPendingTasks = new ArrayList();
            this.lock = new Object();
            this.mIsReady = new AtomicBoolean(false);
            this.mIsStarted = new AtomicBoolean(false);
        }
    }

    public enum StartReason {
        UNKNOWN,
        VOICE_COMMANDS,
        TRANSCRIPTION,
        TYPE_AHEAD
    }

    public static void A09(AssistantService assistantService, AssistantErrorType assistantErrorType) {
        assistantService.A0j = false;
        C0398Vv.A04.removeCallbacks(C0398Vv.A05);
        C0398Vv.A01 = null;
        HandlerC0422Wz.A01();
        YP yp = assistantService.A0a;
        String name = assistantErrorType.name();
        C0139Dd.A09("OculusAssistantInteractionLatencyLogger", "logError");
        YO yo = yp.A01;
        if (yo != null) {
            yo.A01.markerPoint(yo.A00(), "error", AnonymousClass08.A04("error:", name));
        }
        assistantService.A0a.A01();
        assistantService.A0Y.A03(assistantErrorType);
    }

    /* JADX WARNING: Code restructure failed: missing block: B:6:0x002d, code lost:
        r2 = r13.getSharedPreferences("AssistantServiceConfig", 0);
     */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public static void A0C(com.oculus.assistant.service.AssistantService r13, java.lang.String r14) {
        /*
        // Method dump skipped, instructions count: 393
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.A0C(com.oculus.assistant.service.AssistantService, java.lang.String):void");
    }

    private SettingsManager A01() {
        SettingsManager settingsManager = this.A0e;
        if (settingsManager != null) {
            return settingsManager;
        }
        SettingsManager settingsManager2 = new SettingsManager(BX.A00());
        this.A0e = settingsManager2;
        return settingsManager2;
    }

    private void A02() {
        Tracer.A01("initialize");
        try {
            SafeInitializationManager safeInitializationManager = this.A1D;
            if (!safeInitializationManager.mIsReady.get()) {
                C1413yz yzVar = new C1413yz();
                this.A0d = yzVar;
                this.A0c = new C1412yy(yzVar);
                this.A0W = new C1376yB();
                if (Version.CURRENT_SDK_VERSION >= 52) {
                    VoiceAssistantManager voiceAssistantManager = new VoiceAssistantManager();
                    this.A10 = voiceAssistantManager;
                    this.A0V = new C1375yA(voiceAssistantManager);
                }
                SettingsManager A012 = A01();
                SettingsObserverCallback settingsObserverCallback = this.A1M;
                A012.registerSettingsObserver("voice_interaction_storage_enabled", settingsObserverCallback, this.A0r);
                A01().registerSettingsObserver("assistant_wakeword_enabled", settingsObserverCallback, this.A0r);
                registerReceiver(this.A1I, new IntentFilter("com.oculus.intent.action.MOUNT_STATE_CHANGED"));
                registerReceiver(this.A1J, new IntentFilter("com.oculus.assistant.UI_LIFECYCLE_EVENT"));
                IntentFilter intentFilter = new IntentFilter();
                intentFilter.addAction("com.oculus.assistant.QUEUE_MIC_LOG");
                Bd A002 = Bd.A00(BX.A00());
                BroadcastReceiver broadcastReceiver = this.A1H;
                AnonymousClass3Q r7 = A002.A00;
                HashMap hashMap = r7.A02;
                synchronized (hashMap) {
                    AnonymousClass3P r4 = new AnonymousClass3P(intentFilter, broadcastReceiver);
                    ArrayList arrayList = (ArrayList) hashMap.get(broadcastReceiver);
                    if (arrayList == null) {
                        arrayList = new ArrayList(1);
                        hashMap.put(broadcastReceiver, arrayList);
                    }
                    arrayList.add(r4);
                    for (int i = 0; i < intentFilter.countActions(); i++) {
                        String action = intentFilter.getAction(i);
                        HashMap hashMap2 = r7.A01;
                        ArrayList arrayList2 = (ArrayList) hashMap2.get(action);
                        if (arrayList2 == null) {
                            arrayList2 = new ArrayList(1);
                            hashMap2.put(action, arrayList2);
                        }
                        arrayList2.add(r4);
                    }
                }
                safeInitializationManager.setIsReady(true);
                YP yp = this.A0a;
                C0139Dd.A09("OculusAssistantInteractionLatencyLogger", "logInitComplete");
                YO yo = yp.A01;
                if (yo != null) {
                    if (YR.A02(yo.A02, YQ.INTERACTION_STARTED)) {
                        yo.A01.markerPoint(yo.A00(), "initialized");
                    }
                }
                yp.A00.markerPoint(50790403, "initialized");
            }
        } finally {
            Tracer.A00();
        }
    }

    private void A03() {
        C0139Dd.A09("AssistantService", "Stop interaction called to close audio source");
        try {
            this.A0W.close();
            C1375yA yAVar = this.A0V;
            if (yAVar != null) {
                yAVar.close();
            }
        } catch (IOException unused) {
        }
        this.A0a.A01();
    }

    /* JADX WARNING: Code restructure failed: missing block: B:5:0x0020, code lost:
        if (android.preference.PreferenceManager.getDefaultSharedPreferences(r4.getApplicationContext()).getBoolean("audiologging", false) == false) goto L_0x0022;
     */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public static void A04(com.oculus.assistant.service.AssistantService r4) {
        /*
            boolean r3 = r4.A0l
            X.yy r0 = r4.A0c
            if (r0 == 0) goto L_0x0022
            java.util.concurrent.ConcurrentLinkedQueue r0 = r0.A0A
            boolean r0 = r0.isEmpty()
            r0 = r0 ^ 1
            if (r0 != 0) goto L_0x0022
            android.content.Context r0 = r4.getApplicationContext()
            android.content.SharedPreferences r2 = android.preference.PreferenceManager.getDefaultSharedPreferences(r0)
            r1 = 0
            java.lang.String r0 = "audiologging"
            boolean r1 = r2.getBoolean(r0, r1)
            r0 = 1
            if (r1 != 0) goto L_0x0023
        L_0x0022:
            r0 = 0
        L_0x0023:
            r4.A0l = r0
            if (r3 == r0) goto L_0x005f
            if (r0 != 0) goto L_0x005f
            X.yy r0 = r4.A0c
            if (r0 == 0) goto L_0x005f
            X.Yv r0 = r0.A08
            X.Yt r0 = r0.A00
            if (r0 == 0) goto L_0x005f
            java.util.concurrent.atomic.AtomicBoolean r0 = r0.A01
            boolean r0 = r0.get()
            if (r0 == 0) goto L_0x005f
            java.lang.String r1 = "AssistantService"
            java.lang.String r0 = "Aborting recording, auto record was disabled."
            X.C0139Dd.A09(r1, r0)
            X.yy r0 = r4.A0c
            X.Yv r4 = r0.A08
            r3 = 0
            X.Yt r2 = r4.A00
            if (r2 == 0) goto L_0x005f
            java.util.concurrent.atomic.AtomicBoolean r1 = r2.A01
            r0 = 0
            r1.set(r0)
            X.Yv r0 = r2.A02
            X.z3 r1 = new X.z3
            r1.<init>(r0, r3)
            java.util.concurrent.ConcurrentLinkedQueue r0 = r2.A00
            r0.add(r1)
            r4.A00 = r3
        L_0x005f:
            return
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.A04(com.oculus.assistant.service.AssistantService):void");
    }

    /* JADX DEBUG: Failed to insert an additional move for type inference into block B:64:0x0170 */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Type inference failed for: r19v0, types: [java.lang.Iterable] */
    /* JADX WARN: Type inference failed for: r19v1, types: [X.aV] */
    /* JADX WARN: Type inference failed for: r19v2, types: [java.util.AbstractCollection, java.util.ArrayList] */
    /* JADX WARNING: Code restructure failed: missing block: B:59:0x01de, code lost:
        r0 = move-exception;
     */
    /* JADX WARNING: Code restructure failed: missing block: B:60:0x01df, code lost:
        X.C0495ai.A00(r14, r1);
     */
    /* JADX WARNING: Code restructure failed: missing block: B:61:0x01e2, code lost:
        throw r0;
     */
    /* JADX WARNING: Unknown variable types count: 1 */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public static void A05(com.oculus.assistant.service.AssistantService r30) {
        /*
        // Method dump skipped, instructions count: 518
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.A05(com.oculus.assistant.service.AssistantService):void");
    }

    public static void A06(AssistantService assistantService) {
        assistantService.A1E.safeExecute(new XX(assistantService));
    }

    public static void A07(AssistantService assistantService) {
        if (assistantService.A13) {
            Tracer.A01("resumeWakeWordRecognition");
            try {
                if (YN.A02() && YN.A03()) {
                    C0139Dd.A09("WakeWordUtil", "Resuming wake word recognition");
                    new Y5().A02();
                }
            } catch (Exception e) {
                C0139Dd.A0L("WakeWordUtil", "Failed resuming wakeword", e);
                C00799i.A00.logException("Failed resuming wakeword", e);
            } catch (Throwable th) {
                Tracer.A00();
                throw th;
            }
            Tracer.A00();
            assistantService.A13 = false;
        }
        assistantService.A0X.A01();
    }

    public static void A0A(AssistantService assistantService, String str) {
        StringBuilder sb;
        assistantService.A0g = str;
        if (TextUtils.isEmpty(str)) {
            sb = new StringBuilder("[Empty Transcription] - ");
        } else {
            sb = new StringBuilder();
            sb.append(assistantService.A0g);
            sb.append(" - ");
        }
        sb.append(C00799i.A00.mInteractionId);
        assistantService.A0h = sb.toString();
    }

    /* JADX WARNING: Code restructure failed: missing block: B:5:0x0023, code lost:
        if (r0 == false) goto L_0x0025;
     */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public static void A0B(com.oculus.assistant.service.AssistantService r5, java.lang.String r6) {
        /*
        // Method dump skipped, instructions count: 121
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.A0B(com.oculus.assistant.service.AssistantService, java.lang.String):void");
    }

    public static boolean A0F(AssistantService assistantService) {
        Tracer.A01("voiceCommandsEnabled");
        try {
            if (assistantService.A0E()) {
                if (!C0398Vv.A03() || AssistantDeviceSettings.INSTANCE.isInAppVoiceCommandsEnabled()) {
                    Tracer.A00();
                    return true;
                }
                C0139Dd.A09("AssistantService", "Voice Commands not available in game.  Disabled by user.");
                long elapsedRealtime = SystemClock.elapsedRealtime();
                if (!assistantService.A12 && elapsedRealtime - assistantService.A0p < ((long) 30000)) {
                    assistantService.A0Y.A03(AssistantErrorType.NOT_AVAILABLE_IN_GAME);
                    C00799i.A00.logError("not_available_ingame");
                    assistantService.A12 = true;
                }
                assistantService.A0p = elapsedRealtime;
                assistantService.A03();
            }
            return false;
        } finally {
            Tracer.A00();
        }
    }

    /* JADX WARNING: Code restructure failed: missing block: B:15:0x0065, code lost:
        if (r0 == false) goto L_0x0010;
     */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public static boolean A0H(com.oculus.assistant.service.AssistantService r8, java.lang.String r9, java.lang.String r10) {
        /*
        // Method dump skipped, instructions count: 470
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.A0H(com.oculus.assistant.service.AssistantService, java.lang.String, java.lang.String):boolean");
    }

    public static boolean A0I(AssistantService assistantService, String str, boolean z) {
        AssistantLogger assistantLogger;
        String A042;
        C1300wu wuVar;
        int i;
        boolean z2 = false;
        if (assistantService.checkPermission("android.permission.RECORD_AUDIO", Process.myPid(), Process.myUid()) == 0) {
            z2 = true;
        }
        if (z2) {
            if (!AssistantDeviceSettings.INSTANCE.isMicMuted()) {
                if (AssistantDeviceSettings.INSTANCE.isMicrophoneExclusive() && !AssistantDeviceSettings.INSTANCE.isSharedMicAvailable()) {
                    if (!str.equals("voice_interaction") || !YN.A04()) {
                        if (z) {
                            assistantService.A0Y.A03(AssistantErrorType.NOT_AVAILABLE_IN_THIS_GAME);
                            assistantLogger = C00799i.A00;
                            A042 = AnonymousClass08.A04("incompatible_game_", str);
                        }
                    } else if (z) {
                        C00799i.A00.logServiceEvent(AnonymousClass08.A04("bypass_incompatible_game_", str));
                    }
                }
                return true;
            } else if (z) {
                if ("transcription".equals(str)) {
                    wuVar = new C1300wu();
                    wuVar.A0G("dlg-unmute-dictation");
                    wuVar.A0C(R.string.mic_muted_title_dictation);
                    i = R.string.mic_muted_description_dictation;
                } else {
                    if (!"hfb_wakeword".equals(assistantService.A0f)) {
                        wuVar = new C1300wu();
                        wuVar.A0G("dlg-unmute-voicecommands");
                        wuVar.A0C(R.string.mic_muted_title);
                        i = R.string.mic_muted_description;
                    }
                    assistantLogger = C00799i.A00;
                    A042 = "mic_not_available_muted";
                }
                wuVar.A09(i);
                wuVar.A0A(R.string.mic_muted_yes);
                wuVar.A0B(R.string.mic_muted_no);
                wuVar.A0E("system-dialog");
                HandlerC0422Wz.A06.A09(wuVar, true);
                assistantLogger = C00799i.A00;
                A042 = "mic_not_available_muted";
            }
            assistantLogger.logError(A042);
            return false;
        } else if (z) {
            C00799i.A00.logError("mic_not_available_permission");
            C0139Dd.A0D("AssistantService", "User did not grant recording audio permission");
            assistantService.A0Y.A03(AssistantErrorType.MIC_NOT_AVAILABLE);
        }
        return false;
    }

    private boolean A0J(String str) {
        l0 l0Var;
        boolean z = this.A0j;
        if (z) {
            long j = this.A01;
            if (j != 0 && System.currentTimeMillis() - j > 1000) {
                A06(this);
                AssistantLogger assistantLogger = C00799i.A00;
                StringBuilder sb = new StringBuilder("assistant_busy_reset_");
                sb.append(this.A0b);
                assistantLogger.logServiceEvent(sb.toString());
                this.A0j = false;
                this.A0i = true;
                return false;
            }
        }
        if (z) {
            C0740gP gPVar = this.A05;
            if (!(gPVar == null || (l0Var = gPVar.A0B) == null)) {
                l0Var.A03();
            }
            C0139Dd.A0D("AssistantService", "Assistant is busy.");
            AssistantLogger assistantLogger2 = C00799i.A00;
            StringBuilder sb2 = new StringBuilder();
            sb2.append(System.currentTimeMillis() - this.A01);
            assistantLogger2.logError("assistant_busy", sb2.toString());
            this.A00++;
            if (W0.A00().A00.getBoolean("reset_if_busy", true)) {
                if (((long) this.A00) >= W0.A00().A00.getLong("num_is_busy_before_reset", 3)) {
                    assistantLogger2.logServiceEvent("assistant_busy_reset");
                    stopSelf();
                    return false;
                }
            }
            return false;
        }
        this.A00 = 0;
        return A0I(this, str, true);
    }

    public final void A0K() {
        if (!this.A0m && C0408Wk.A02) {
            HandlerC0422Wz.A00();
            if (3 != HandlerC0422Wz.A00().A00 && Z4.A00.getBoolean("show_mini_nux", true) && !Z4.A02()) {
                new WV(this.A1K).A01();
                return;
            }
        }
        Tracer.A01("activateAssistant");
        try {
            C0398Vv.A04.removeCallbacks(C0398Vv.A05);
            C0398Vv.A01 = null;
            HandlerC0422Wz.A01();
            HandlerC0422Wz.A07(false);
            HandlerC0422Wz.A06.A08();
            if (A0J("voice_interaction")) {
                C0740gP gPVar = this.A05;
                if (gPVar != null && !gPVar.A13.get()) {
                    this.A05.A0C();
                }
                A04(this);
                this.A1E.safeExecute(new XR(this));
            }
        } finally {
            Tracer.A00();
        }
    }

    public final void A0L() {
        boolean z;
        if (!A0J("transcription")) {
            return;
        }
        if (!A0D()) {
            C0139Dd.A0A("AssistantService", "Transcription not enabled.");
            this.A0Y.A04(AssistantInteractionState.INACTIVE);
            return;
        }
        HandlerC0422Wz.A07(true);
        C0740gP gPVar = this.A05;
        if (gPVar != null && !gPVar.A13.get()) {
            this.A05.A0C();
        }
        A04(this);
        this.A0j = true;
        this.A0h = "Transcription Recording";
        A0B(this, "transcription");
        try {
            Y4 y4 = this.A0X;
            C1412yy yyVar = this.A0c;
            C0514bB.A02(yyVar, "audioSource");
            if (y4.A00) {
                y4.A01();
            }
            C0139Dd.A0D("DictationServiceManager", "Starting transcription.");
            YP yp = y4.A0B;
            C00618l r2 = y4.A02;
            String str = r2.A04;
            C1399yd ydVar = yp.A03;
            ydVar.A02(str);
            yp.A01 = ydVar;
            ydVar.A01();
            yyVar.open();
            r2.A05 = "keyboard_assistant";
            if (r2.A06 == null) {
                Y4.A00(y4);
            }
            C00608k r6 = y4.A01;
            r6.A02 = r2;
            int i = r2.A00;
            if (i != 0) {
                r6.A00 = i;
            }
            C00648r r9 = r6.A0A;
            C0112Aq A002 = C0112Aq.A00();
            A002.A02(C0772gy.class, r9.A02);
            A002.A02(C0774h0.class, r9.A03);
            A002.A02(C0811hz.class, r9.A01);
            A002.A02(C0806hu.class, r9.A00);
            A002.A02(h4.class, r9.A04);
            A002.A02(C0776h5.class, r9.A05);
            r6.A03.A02(C0772gy.class, r6.A0D);
            r6.A03.A02(C0774h0.class, r6.A0E);
            r6.A03.A02(C0801hp.class, r6.A0B);
            C0112Aq aq = y4.A0A;
            aq.A01(new C0801hp(yyVar));
            aq.A01(new C0772gy());
            y4.A00 = true;
            Tracer.A01("pauseWakeWordRecognition");
            try {
                if (YN.A04()) {
                    C0139Dd.A09("WakeWordUtil", "Pausing wake word recognition");
                    new Y5().A00();
                    Tracer.A00();
                    z = true;
                    this.A13 = z;
                    this.A0Y.A04(AssistantInteractionState.ACTIVATED);
                }
            } catch (Exception e) {
                C0139Dd.A0L("WakeWordUtil", "Failed pausing wakeword", e);
                C00799i.A00.logException("Failed pausing wakeword", e);
            } catch (Throwable th) {
                Tracer.A00();
                throw th;
            }
            Tracer.A00();
            z = false;
            this.A13 = z;
            this.A0Y.A04(AssistantInteractionState.ACTIVATED);
        } catch (IOException e2) {
            A09(this, AssistantErrorType.MIC_NOT_AVAILABLE);
            String message = e2.getMessage();
            AssistantLogger assistantLogger = C00799i.A00;
            if (message != null) {
                assistantLogger.logError("mic_not_available_ioexception", e2.getMessage());
            } else {
                assistantLogger.logError("mic_not_available_ioexception");
            }
        }
    }

    public final void A0M(AbstractC0447Yr yr) {
        C0139Dd.A0F("AssistantService", "Removing audio source: %s", yr);
        this.A0d.A00(yr);
    }

    public final IBinder onBind(Intent intent) {
        if (this.A11) {
            return null;
        }
        A02();
        if ("com.oculus.assistant.ACTION_UI_CONTROL_SERVICE".equals(intent.getAction())) {
            if (this.A0w == null) {
                this.A0w = new Y7(this.A1K);
            }
            C00799i.A00.logServiceEvent("panel_bind");
            IBinder binder = HandlerC0422Wz.A03.getBinder();
            C0514bB.A01(binder, "incomingMessenger.binder");
            return binder;
        } else if ("com.oculus.assistant.ACTION_SYSTEM_ATTENTION_LISTENER".equals(intent.getAction())) {
            C00799i.A00.logServiceEvent("attention_system_bind");
            return new AssistantBinder() {
                /* class com.oculus.assistant.service.AssistantService.AnonymousClass7 */

                @Override // com.oculus.assistant.service.AssistantService.AssistantBinder, com.oculus.assistant.service.api.IOculusAssistantService
                public IOculusAssistantAttentionService getAttentionService() {
                    return new AttentionBinder() {
                        /* class com.oculus.assistant.service.AssistantService.AnonymousClass7.AnonymousClass1 */

                        {
                            AssistantService assistantService = AssistantService.this;
                        }

                        @Override // com.oculus.assistant.service.AssistantService.AttentionBinder
                        public String onAddAttentionListener(String str, IOculusAssistantAttentionListener iOculusAssistantAttentionListener) {
                            if (SystemUXUtil.A00() >= 1) {
                                return OacrConstants.AUTO_SPEECH_DOMAIN;
                            }
                            AssistantService assistantService = AssistantService.this;
                            YB yb = assistantService.A0Y;
                            return YB.A00(yb, yb.A0B, str, new SystemAttentionPrePushHandler(assistantService, iOculusAssistantAttentionListener));
                        }

                        @Override // com.oculus.assistant.service.AssistantService.AttentionBinder
                        public void onRemoveAttentionListener(String str) {
                            if (SystemUXUtil.A00() < 1) {
                                AssistantService.this.A0Y.A0B.A01(str);
                            }
                        }
                    };
                }
            };
        } else if ("com.oculus.assistant.ENTRY_SERVICE".equals(intent.getAction())) {
            return this.A0t;
        } else {
            return this.A1L;
        }
    }

    public final void onCreate() {
        Tracer.A01("onCreate");
        try {
            A1N = this;
            C0139Dd.A00(3);
            C0139Dd.A09("AssistantService", "OnCreate");
            Process.setThreadPriority(-16);
            yZ yZVar = yZ.A03;
            if (yZVar == null) {
                yZVar = new yZ();
                yZ.A03 = yZVar;
            }
            AssistantLogger assistantLogger = C00799i.A00;
            C0139Dd.A0B("AssistantLogger", "Setting AnalyticsManager");
            assistantLogger.mAnalyticsManager = yZVar;
            assistantLogger.mStructuredLogger.A00 = yZVar;
            assistantLogger.mXAnalyticsProvider.A00 = yZVar;
            A4.A00 = new C1423zG(yZ.A00(), yZVar.A02);
            if (A4.A01) {
                C0139Dd.A0B("AssistantQuickPerfLoggerProvider", "Multiple initialization! Overwriting current HoneyClientLogger.");
            }
            A4.A01 = true;
            PowerManager powerManager = (PowerManager) getApplicationContext().getSystemService("power");
            if (powerManager != null) {
                A4.A06.add(new hN(powerManager));
                A4.A02 = true;
            }
            ActivityManager activityManager = (ActivityManager) getApplicationContext().getSystemService(AppComponentStats.TAG_ACTIVITY);
            if (activityManager != null) {
                A4.A06.add(new hO(activityManager));
                A4.A03 = true;
            }
            AbstractC00889s.A03 = new C1396yX();
            YP A002 = YP.A00();
            this.A0a = A002;
            C0139Dd.A09("OculusAssistantInteractionLatencyLogger", "startColdStart");
            A002.A00.markerStart(50790403);
            A002.A00.markerAnnotate(50790403, "assistant_app_version", A002.A02.A01());
            A002.A00.markerAnnotate(50790403, "start_type", "cold");
            if (!assistantLogger.mIsNewSession) {
                assistantLogger.mIsNewSession = true;
                assistantLogger.mInteractionId = UUID.randomUUID().toString();
            }
            assistantLogger.logServiceEvent("service_start");
            this.A0q = (KeyguardManager) getSystemService("keyguard");
            this.A08 = new C1349xh(this);
            this.A07 = new C1333xR(this);
            this.A09 = new C1329xN(this);
            C1353xl xlVar = new C1353xl(this);
            this.A0K = xlVar;
            this.A0J = new C1342xa(this);
            this.A0C = new C1346xe(this);
            this.A0I = new C1338xW(this);
            this.A0G = new C1331xP(this);
            this.A0L = new C1343xb(this);
            this.A0H = new C1341xZ(this);
            this.A0M = new C1352xk(this);
            this.A0P = new C1330xO(this);
            this.A0D = new C1340xY(this);
            this.A0B = new C1350xi(this);
            this.A0E = new C1332xQ(this);
            this.A0F = new C1336xU(this);
            C0112Aq aq = this.A18;
            aq.A02(C0809hx.class, xlVar);
            aq.A02(C0808hw.class, this.A0J);
            aq.A02(C0803hr.class, this.A0C);
            aq.A02(C0807hv.class, this.A0I);
            aq.A02(C0805ht.class, this.A0G);
            aq.A02(C0811hz.class, this.A0L);
            aq.A02(C0806hu.class, this.A0H);
            aq.A02(i0.class, this.A0M);
            aq.A02(C0802hq.class, this.A0B);
            aq.A02(C1261wH.class, this.A0E);
            aq.A02(C1262wI.class, this.A0F);
            aq.A02(C0775h2.class, this.A17);
            aq.A02(C1209vO.class, this.A15);
            aq.A02(C1210vP.class, this.A16);
            aq.A02(C0771gx.class, this.A14);
            aq.A02(C1259wF.class, this.A0D);
            aq.A02(C1293wn.class, this.A08);
            aq.A02(C1286wg.class, this.A07);
            aq.A02(C1294wo.class, this.A09);
            aq.A02(i3.class, this.A0P);
            C1345xd xdVar = new C1345xd(this);
            this.A0A = xdVar;
            aq.A02(C0789hc.class, xdVar);
            if (this.A0t == null) {
                this.A0t = new AssistantEntryManager(getApplicationContext());
            }
            this.A0s.start();
            this.A0r = new Handler(this.A0s.getLooper());
            if (this.A0Y == null) {
                this.A0Y = new YB(BX.A00());
                if (SystemUXUtil.A00() >= 1) {
                    YB yb = this.A0Y;
                    YB.A00(yb, yb.A0B, "system_push_handler", new SystemAttentionPushHandler(this));
                }
            }
            this.A0U = new Y0();
            BX.A00().sendBroadcast(SystemUXUtil.A04("request-panel-status"));
            C1351xj xjVar = new C1351xj(this);
            CopyOnWriteArrayList copyOnWriteArrayList = HandlerC0422Wz.A04.A01;
            if (!copyOnWriteArrayList.contains(xjVar)) {
                copyOnWriteArrayList.add(xjVar);
            }
            HandlerC0422Wz.A04(new C1337xV(this));
            HandlerC0422Wz.A04(new C1347xf(this));
            if (Build.VERSION.SDK_INT >= 26) {
                startForeground(70000, A00());
            }
            this.A0Z = new C1383yK(A01());
            this.A0r.post(new XV(this));
            assistantLogger.mDeviceContextProvider = this.A0Z;
            boolean z = false;
            if (!AssistantDeviceSettings.INSTANCE.isVoiceStorageEnabled()) {
                z = true;
            }
            assistantLogger.mDoNotStoreInteractions = z;
            this.A0r.post(new XK(this));
        } finally {
            Tracer.A00();
        }
    }

    public final void onDestroy() {
        super.onDestroy();
        BX.A00().stopService(new Intent(BX.A00(), AssistantDumpService.class));
        if (!this.A11) {
            this.A1G.set(true);
            A1N = null;
            unregisterReceiver(this.A1I);
            unregisterReceiver(this.A1J);
            Bd A002 = Bd.A00(BX.A00());
            BroadcastReceiver broadcastReceiver = this.A1H;
            Map map = A002.A04;
            synchronized (map) {
                AnonymousClass3Q r0 = A002.A00;
                HashMap hashMap = r0.A02;
                synchronized (hashMap) {
                    ArrayList arrayList = (ArrayList) hashMap.remove(broadcastReceiver);
                    if (arrayList != null) {
                        for (int size = arrayList.size() - 1; size >= 0; size--) {
                            AnonymousClass3P r6 = (AnonymousClass3P) arrayList.get(size);
                            r6.A00 = true;
                            for (int i = 0; i < r6.A02.countActions(); i++) {
                                String action = r6.A02.getAction(i);
                                HashMap hashMap2 = r0.A01;
                                ArrayList arrayList2 = (ArrayList) hashMap2.get(action);
                                if (arrayList2 != null) {
                                    for (int size2 = arrayList2.size() - 1; size2 >= 0; size2--) {
                                        AnonymousClass3P r1 = (AnonymousClass3P) arrayList2.get(size2);
                                        if (r1.A01 == broadcastReceiver) {
                                            r1.A00 = true;
                                            arrayList2.remove(size2);
                                        }
                                    }
                                    if (arrayList2.size() <= 0) {
                                        hashMap2.remove(action);
                                    }
                                }
                            }
                        }
                    }
                }
                List list = (List) map.remove(broadcastReceiver);
                if (list != null) {
                    for (int i2 = 0; i2 < list.size(); i2++) {
                        IntentFilter intentFilter = (IntentFilter) list.get(i2);
                        for (int i3 = 0; i3 < intentFilter.countActions(); i3++) {
                            String action2 = intentFilter.getAction(i3);
                            Map map2 = A002.A02;
                            List list2 = (List) map2.get(action2);
                            if (list2 != null) {
                                for (int i4 = 0; i4 < list2.size(); i4++) {
                                    if (((Bc) list2.get(i4)).A02 == broadcastReceiver) {
                                        list2.remove(i4);
                                        throw new NullPointerException("mRefCount");
                                    }
                                }
                                if (list2.isEmpty()) {
                                    map2.remove(action2);
                                }
                            }
                        }
                    }
                }
            }
            ((NotificationManager) this.A0Y.A08.getSystemService("notification")).cancel(1000);
            C0112Aq aq = this.A18;
            aq.A01(new C1210vP());
            if (this.A0j) {
                A06(this);
            }
            C0403Wf wf = this.A0R;
            if (wf != null) {
                wf.A00();
            }
            this.A0R = null;
            aq.A04(C0809hx.class, this.A0K);
            aq.A04(C0808hw.class, this.A0J);
            aq.A04(C0803hr.class, this.A0C);
            aq.A04(C0807hv.class, this.A0I);
            aq.A04(C0805ht.class, this.A0G);
            aq.A04(C0811hz.class, this.A0L);
            aq.A04(C0806hu.class, this.A0H);
            aq.A04(i0.class, this.A0M);
            aq.A04(C1261wH.class, this.A0E);
            aq.A04(C1262wI.class, this.A0F);
            aq.A04(C0802hq.class, this.A0B);
            aq.A04(C0775h2.class, this.A17);
            aq.A04(C1209vO.class, this.A15);
            aq.A04(C1210vP.class, this.A16);
            aq.A04(C0771gx.class, this.A14);
            aq.A04(C1259wF.class, this.A0D);
            aq.A04(z6.class, this.A0N);
            aq.A04(z7.class, this.A0O);
            aq.A04(C1293wn.class, this.A08);
            aq.A04(C1286wg.class, this.A07);
            aq.A04(C1294wo.class, this.A09);
            aq.A04(i3.class, this.A0P);
            aq.A04(C0789hc.class, this.A0A);
            OculusTypeaheadProvider oculusTypeaheadProvider = this.A0z;
            if (oculusTypeaheadProvider != null) {
                oculusTypeaheadProvider.A06.A04(C0776h5.class, oculusTypeaheadProvider.A05);
                oculusTypeaheadProvider.A06.A04(C1255wB.class, oculusTypeaheadProvider.A04);
                oculusTypeaheadProvider.A06.A04(C1260wG.class, oculusTypeaheadProvider.A03);
            }
            Y4 y4 = this.A0X;
            if (y4 != null) {
                C0112Aq aq2 = y4.A0A;
                aq2.A04(C1255wB.class, y4.A07);
                aq2.A04(C1260wG.class, y4.A09);
                aq2.A04(C0809hx.class, y4.A06);
                aq2.A04(C0811hz.class, y4.A08);
                aq2.A04(C0806hu.class, y4.A04);
                aq2.A04(C1204vJ.class, y4.A03);
                aq2.A04(C0808hw.class, y4.A05);
            }
            Y2 y2 = this.A0v;
            if (y2 != null) {
                C0112Aq aq3 = y2.A05;
                aq3.A04(C1255wB.class, y2.A00);
                aq3.A04(C1260wG.class, y2.A04);
                aq3.A04(i0.class, y2.A01);
                aq3.A04(C1202vH.class, y2.A02);
                aq3.A04(C1203vI.class, y2.A03);
            }
            YJ yj = this.A0x;
            if (yj != null) {
                C0112Aq aq4 = yj.A04;
                aq4.A04(C1255wB.class, yj.A00);
                aq4.A04(C1260wG.class, yj.A03);
                aq4.A04(vR.class, yj.A01);
                aq4.A04(C1213vT.class, yj.A02);
            }
            YM ym = this.A0y;
            if (ym != null) {
                C0112Aq aq5 = ym.A07;
                aq5.A04(C1220va.class, ym.A01);
                aq5.A04(C1222vc.class, ym.A02);
                aq5.A04(C1223vd.class, ym.A05);
                aq5.A04(C1224ve.class, ym.A06);
                aq5.A04(C1255wB.class, ym.A04);
                aq5.A04(C1260wG.class, ym.A03);
            }
            C0740gP gPVar = this.A05;
            if (gPVar != null) {
                gPVar.A0B();
                this.A05.A0D();
                this.A05 = null;
            }
            C1412yy yyVar = this.A0c;
            if (yyVar != null) {
                try {
                    yyVar.close();
                } catch (IOException e) {
                    C0139Dd.A0L("AssistantService", "onDestroy: ", e);
                }
                this.A0c = null;
            }
            AssistantEntryManager assistantEntryManager = this.A0t;
            if (assistantEntryManager != null) {
                W9 w9 = assistantEntryManager.A03;
                synchronized (w9) {
                    if (w9.A00 != null) {
                        w9.A02.unbindService(w9.A03);
                        C0139Dd.A09("AuthServiceClient", "Disconnected from OVRAuth");
                        w9.A00 = null;
                    }
                }
                assistantEntryManager.A00.A04(C1257wD.class, assistantEntryManager.A08);
                assistantEntryManager.A00.A04(C1258wE.class, assistantEntryManager.A09);
                assistantEntryManager.A00.A04(C1256wC.class, assistantEntryManager.A07);
                assistantEntryManager.A00.A04(C1254wA.class, assistantEntryManager.A06);
            }
            VoiceSelectionDialog voiceSelectionDialog = this.A0S;
            if (voiceSelectionDialog != null) {
                HandlerC0422Wz.A07.remove(((C1300wu) voiceSelectionDialog).A01.getString("id"));
            }
            C0139Dd.A09("AssistantMessageBus", "Shutdown");
            C0112Aq.A05 = null;
            aq.A04.set(true);
            aq.A03.clear();
            SettingsManager A012 = A01();
            SettingsObserverCallback settingsObserverCallback = this.A1M;
            A012.unregisterSettingsObserver("voice_interaction_storage_enabled", settingsObserverCallback);
            A01().unregisterSettingsObserver("assistant_wakeword_enabled", settingsObserverCallback);
            this.A0s.quitSafely();
            this.A0s = null;
            HandlerC0422Wz.A07.clear();
            HandlerC0422Wz.A05.A01.clear();
            HandlerC0422Wz.A04.A01.clear();
        }
    }

    public final int onStartCommand(Intent intent, int i, int i2) {
        String str;
        Tracer.A01("onStartCommand");
        try {
            if (!this.A11) {
                A02();
                if (intent != null) {
                    String action = intent.getAction();
                    switch (action.hashCode()) {
                        case -1684864673:
                            if (action.equals("com.oculus.assistant.ACTION_HANDLE_ASYNC_DIALOG_RESPONSE")) {
                                String stringExtra = intent.getStringExtra("id");
                                String stringExtra2 = intent.getStringExtra("action");
                                Bundle bundleExtra = intent.getBundleExtra("extras");
                                C0139Dd.A0H("AssistantService", "Received async dialog action: %s from %s", stringExtra2, stringExtra);
                                if (stringExtra != null && stringExtra.hashCode() == -810564157 && stringExtra.equals("dlg-voice-selection")) {
                                    RunnableC0423Xa xa = new RunnableC0423Xa(this, stringExtra, stringExtra2, bundleExtra);
                                    SafeInitializationManager safeInitializationManager = this.A1F;
                                    if (!safeInitializationManager.mIsReady.get()) {
                                        this.A1E.safeExecute(new XU(this));
                                    }
                                    safeInitializationManager.safeExecute(xa);
                                    break;
                                }
                            }
                            break;
                        case -597465111:
                            if (action.equals("com.oculus.assistant.ACTION_SHOW_DIALOG")) {
                                String stringExtra3 = intent.getStringExtra("dialog_id");
                                if (stringExtra3.hashCode() == -810564157 && stringExtra3.equals("dlg-voice-selection")) {
                                    if (A0G(this, "voice_interaction")) {
                                        XP xp = new XP(this);
                                        SafeInitializationManager safeInitializationManager2 = this.A1F;
                                        if (!safeInitializationManager2.mIsReady.get()) {
                                            this.A1E.safeExecute(new XU(this));
                                        }
                                        safeInitializationManager2.safeExecute(xp);
                                        break;
                                    } else {
                                        C1300wu wuVar = new C1300wu();
                                        wuVar.A0G("dlg-voice-selection-pre-nux");
                                        wuVar.A0C(R.string.voice_selection_pre_nux_title);
                                        wuVar.A09(R.string.voice_selection_pre_nux_description);
                                        wuVar.A0A(R.string.voice_selection_pre_nux_primary_button);
                                        wuVar.A0B(R.string.voice_selection_pre_nux_secondary_button);
                                        wuVar.A0E("system-dialog");
                                        HandlerC0422Wz.A06.A09(wuVar, true);
                                        C00799i.A00.logServiceEvent("Voice Selection - Pre Nux");
                                        break;
                                    }
                                }
                            }
                            break;
                        case 399494726:
                            if (action.equals("com.oculus.assistant.ACTIVATE_ASSISTANT_HELP")) {
                                this.A1E.safeExecute(XY.A00);
                                break;
                            }
                            break;
                        case 470348379:
                            if (action.equals("com.oculus.assistant.DEACTIVATE_ASSISTANT")) {
                                A06(this);
                                break;
                            }
                            break;
                        case 961671706:
                            if (action.equals("com.oculus.assistant.ACTIVATE_ASSISTANT")) {
                                try {
                                    AssistantLogger assistantLogger = C00799i.A00;
                                    if (!assistantLogger.mIsNewSession) {
                                        assistantLogger.mIsNewSession = true;
                                        assistantLogger.mInteractionId = UUID.randomUUID().toString();
                                    }
                                    if (intent.hasExtra("source")) {
                                        this.A0f = intent.getStringExtra("source");
                                    } else if (intent.hasExtra("intent_pkg")) {
                                        String stringExtra4 = intent.getStringExtra("intent_pkg");
                                        if ("com.oculus.vrshell".equals(stringExtra4) || "com.oculus.shellenv".equals(stringExtra4)) {
                                            this.A0f = "doubletap_inshell";
                                        } else {
                                            this.A0f = "doubletap_ingame";
                                        }
                                    } else {
                                        this.A0f = "AUI";
                                    }
                                    if (intent.hasExtra("beginIdx")) {
                                        this.A02 = intent.getLongExtra("beginIdx", 0);
                                    }
                                    if (intent.hasExtra("endIdx")) {
                                        this.A03 = intent.getLongExtra("endIdx", 0);
                                    }
                                    assistantLogger.logServiceEvent(AnonymousClass08.A04("start_command_", this.A0f));
                                    this.A0T = StartReason.VOICE_COMMANDS;
                                    KeyguardManager keyguardManager = this.A0q;
                                    if (keyguardManager == null || !keyguardManager.isDeviceLocked()) {
                                        if (this.A0n || Z4.A02() || Z4.A00.getBoolean("keep_panel_on_activation", false)) {
                                            Z4.A00.edit().putBoolean("keep_panel_on_activation", false).apply();
                                        } else {
                                            HandlerC0422Wz.A02();
                                        }
                                        if (A0G(this, "voice_interaction") || !C0398Vv.A03()) {
                                            if (A0G(this, "voice_interaction") || Z4.A02()) {
                                                if (A0F(this) && !this.A0o) {
                                                    SafeInitializationManager safeInitializationManager3 = this.A1E;
                                                    if (!safeInitializationManager3.mIsReady.get()) {
                                                        HandlerC0422Wz wz = HandlerC0422Wz.A06;
                                                        wz.A08();
                                                        if (wz.A0C()) {
                                                            X0 x0 = new X0();
                                                            x0.A03 = Integer.valueOf((int) ErrorReporter.MAX_ANR_TRACES_TIME_DELTA_MS);
                                                            wz.A0A(x0);
                                                        }
                                                        this.A0r.post(new XQ(this));
                                                    }
                                                    this.A0o = true;
                                                    this.A0a.A04(this.A0f);
                                                    safeInitializationManager3.safeExecute(new XT(this));
                                                }
                                            } else if (C0398Vv.A06 || (str = this.A0f) == null || str.contains("AUI") || "doubletap_inshell".equals(this.A0f)) {
                                                this.A1C.safeExecute(new XW(this));
                                            } else {
                                                stopSelf();
                                            }
                                        } else if (!"doubletap_ingame".equals(this.A0f)) {
                                            HandlerC0422Wz wz2 = HandlerC0422Wz.A06;
                                            X0 x02 = new X0();
                                            x02.A01(R.string.assistant_nux_in_game_error);
                                            wz2.A0A(x02);
                                        }
                                    } else {
                                        C0139Dd.A0A("AssistantService", "Device is locked. Ignoring.");
                                    }
                                    break;
                                } finally {
                                    Tracer.A00();
                                }
                            }
                            break;
                    }
                }
            }
            return 2;
        } finally {
            Tracer.A00();
        }
    }

    public AssistantService() {
        C0112Aq aq = C0112Aq.A05;
        if (aq != null) {
            C0139Dd.A09("AssistantMessageBus", "Shutdown");
            C0112Aq.A05 = null;
            aq.A04.set(true);
            aq.A03.clear();
        }
        C0112Aq aq2 = new C0112Aq();
        C0112Aq.A05 = aq2;
        this.A18 = aq2;
        this.A15 = new C1348xg(this);
        this.A16 = new C1339xX(this);
        this.A17 = C1335xT.A00;
        this.A14 = new C1334xS(this);
        this.A0s = new HandlerThread("OculusAssistantService");
        this.A1K = HandlerC0422Wz.A06;
        this.A0k = false;
        this.A00 = 0;
        this.A02 = 0;
        this.A03 = 0;
        this.A1H = new BroadcastReceiver() {
            /* class com.oculus.assistant.service.AssistantService.AnonymousClass2 */

            public void onReceive(Context context, Intent intent) {
                if ("com.oculus.assistant.QUEUE_MIC_LOG".equals(intent.getAction())) {
                    String stringExtra = intent.getStringExtra("playback_name");
                    C0139Dd.A0F("AssistantService", "Received request to play history file: %s", stringExtra);
                    AssistantService assistantService = AssistantService.this;
                    if (stringExtra != null) {
                        C1412yy yyVar = assistantService.A0c;
                        if (BX.A00().checkSelfPermission("android.permission.READ_EXTERNAL_STORAGE") == 0) {
                            String externalStorageState = Environment.getExternalStorageState();
                            if ("mounted".equals(externalStorageState) || "mounted_ro".equals(externalStorageState)) {
                                yyVar.A0A.add(stringExtra);
                                AssistantService.A04(assistantService);
                            }
                        }
                        C0139Dd.A0D("AudioInputLogSource", "External storage is not readable. Cannot play back log.");
                        AssistantService.A04(assistantService);
                    }
                }
            }
        };
        this.A1I = new BroadcastReceiver() {
            /* class com.oculus.assistant.service.AssistantService.AnonymousClass3 */

            public void onReceive(Context context, Intent intent) {
                if (intent.getAction().equals("com.oculus.intent.action.MOUNT_STATE_CHANGED") && !intent.getExtras().getBoolean("state")) {
                    AssistantService assistantService = AssistantService.this;
                    if (assistantService.A0R != null) {
                        assistantService.A18.A01(new C1284we(AnonymousClass09.A01, true));
                    }
                    AssistantService.this.stopSelf();
                    HandlerC0422Wz.A02();
                }
            }
        };
        this.A1L = new AssistantBinder();
        this.A19 = new AnonymousClass4();
        this.A1B = new AttentionBinder();
        this.A1A = new AnonymousClass5();
        this.A1M = new SettingsObserverCallback() {
            /* class com.oculus.assistant.service.AssistantService.AnonymousClass6 */

            public void onSettingChange(String str) {
                String str2;
                String str3;
                C0139Dd.A0F("AssistantService", "SETTINGS OBSERVER CALLED FOR %s", str);
                if (AssistantService.this.A0e != null && "voice_interaction_storage_enabled".equals(str)) {
                    boolean isVoiceStorageEnabled = AssistantDeviceSettings.INSTANCE.isVoiceStorageEnabled();
                    if (isVoiceStorageEnabled) {
                        str3 = "VoiceInteractionStorage Enabled";
                    } else {
                        str3 = "VoiceInteractionStorage Disabled";
                    }
                    C0139Dd.A09("AssistantService", str3);
                    C00799i.A00.mDoNotStoreInteractions = !isVoiceStorageEnabled;
                }
                if (AssistantService.this.A0e != null && "assistant_wakeword_enabled".equals(str) && Version.CURRENT_SDK_VERSION >= 52) {
                    AssistantLogger assistantLogger = C00799i.A00;
                    if (AssistantDeviceSettings.INSTANCE.isWakeWordEnabled()) {
                        str2 = "WakeWord - enabled";
                    } else {
                        str2 = "WakeWord - disabled";
                    }
                    assistantLogger.logServiceEvent(str2);
                    if (!YN.A03() && !AssistantService.this.A0d.isAudioDataPcm()) {
                        C0139Dd.A09("AssistantService", "Audio data is Native source switching to OVR Audio source");
                        AssistantService assistantService = AssistantService.this;
                        assistantService.A0d.A00(assistantService.A0V);
                        AssistantService assistantService2 = AssistantService.this;
                        assistantService2.A0d.A01(assistantService2.A0W, 1000);
                    }
                }
            }
        };
    }

    private Notification A00() {
        String packageName = getPackageName();
        NotificationChannel notificationChannel = new NotificationChannel(packageName, packageName, 3);
        notificationChannel.setDescription(packageName);
        notificationChannel.setSound(null, null);
        ((NotificationManager) getSystemService("notification")).createNotificationChannel(notificationChannel);
        return new Notification.Builder(this, packageName).setSmallIcon(R.drawable.voice_assistant_filled_24).setPriority(1).build();
    }

    private boolean A0D() {
        AssistantLogger assistantLogger;
        String str;
        if (!W0.A00().A00.getBoolean("enabled", true)) {
            C0139Dd.A0A("AssistantService", "Assistant is not enabled for this user on this device");
            this.A11 = true;
            assistantLogger = C00799i.A00;
            str = "gk_not_enabled";
        } else if (W0.A00().A00.getBoolean("enable_transcription", true)) {
            return true;
        } else {
            C0139Dd.A09("AssistantService", "Transcription disabled on this device.");
            assistantLogger = C00799i.A00;
            str = "transcription_gk_not_enabled";
        }
        assistantLogger.logServiceEvent(str);
        A03();
        return false;
    }

    private boolean A0E() {
        AssistantLogger assistantLogger;
        String str;
        boolean z = false;
        if (W0.A00().A00.getBoolean("voice_commands_disabled", false)) {
            C0139Dd.A09("AssistantService", "Voice Commands disabled on this device.");
            C00799i.A00.logServiceEvent("voicecommands_gk_not_enabled");
            A03();
        } else {
            z = true;
            if (!W0.A00().A00.getBoolean("enabled", true)) {
                C0139Dd.A0A("AssistantService", "Assistant is not enabled for this user on this device");
                this.A11 = true;
                assistantLogger = C00799i.A00;
                str = "gk_not_enabled";
            } else if (!W0.A00().A00.getBoolean("os_version_enabled", true)) {
                C0139Dd.A0A("AssistantService", "Assistant is not enabled on this OS version");
                this.A0Y.A03(AssistantErrorType.OLD_OS_VERSION);
                this.A11 = true;
                assistantLogger = C00799i.A00;
                str = "os_not_enabled";
            }
            assistantLogger.logServiceEvent(str);
            A03();
            return false;
        }
        return z;
    }

    public static boolean A0G(AssistantService assistantService, String str) {
        SharedPreferences sharedPreferences;
        String str2;
        if (C0149Dq.A00() || assistantService.A0m) {
            C0139Dd.A0O("AssistantService", "IsE2E.  Skipping NUX for %s", str);
            return true;
        }
        if (str.equals("transcription")) {
            sharedPreferences = Z4.A00;
            str2 = "transcription_privacy_acknowledge";
        } else if (str.equals("voice_interaction")) {
            sharedPreferences = Z4.A00;
            str2 = "interaction_privacy_acknowledge";
        } else {
            C0139Dd.A0P("AssistantService", "Unknown action: ", str);
            return false;
        }
        return sharedPreferences.getBoolean(str2, false);
    }

    public final void onTrimMemory(int i) {
        super.onTrimMemory(i);
        Integer valueOf = Integer.valueOf(i);
        C0139Dd.A0O("AssistantService", "onTrimMemory %d", valueOf);
        boolean z = this.A0j;
        AssistantLogger assistantLogger = C00799i.A00;
        if (!z) {
            assistantLogger.logServiceEvent("Trim Memory - Success");
            C0139Dd.A0O("AssistantService", "Stopping service because of low memory.", valueOf);
            if (i == 15) {
                YN.A01(BX.A00().getApplicationContext());
                assistantLogger.logServiceEvent("Trim Memory - Stop WakeWord");
            }
            stopSelf();
            return;
        }
        assistantLogger.logServiceEvent("Trim Memory - Fail");
    }

    /* JADX WARNING: Removed duplicated region for block: B:11:0x002e  */
    /* JADX WARNING: Removed duplicated region for block: B:16:? A[RETURN, SYNTHETIC] */
    /* Code decompiled incorrectly, please refer to instructions dump. */
    public final boolean onUnbind(android.content.Intent r4) {
        /*
            r3 = this;
            java.lang.String r0 = r4.getAction()
            java.lang.String r2 = "com.oculus.assistant.ACTION_UI_CONTROL_SERVICE"
            boolean r0 = r2.equals(r0)
            if (r0 == 0) goto L_0x003a
            com.facebook.assistant.clientplatform.logger.AssistantLogger r1 = X.C00799i.A00
            java.lang.String r0 = "panel_unbind"
        L_0x0010:
            r1.logServiceEvent(r0)
        L_0x0013:
            boolean r0 = r3.A0j
            if (r0 == 0) goto L_0x0024
            java.lang.String r0 = r4.getAction()
            boolean r0 = r2.equals(r0)
            if (r0 != 0) goto L_0x0024
            A06(r3)
        L_0x0024:
            java.lang.String r0 = r4.getAction()
            boolean r0 = r2.equals(r0)
            if (r0 != 0) goto L_0x0038
            X.Aq r1 = r3.A18
            X.vP r0 = new X.vP
            r0.<init>()
            r1.A01(r0)
        L_0x0038:
            r0 = 0
            return r0
        L_0x003a:
            java.lang.String r1 = r4.getAction()
            java.lang.String r0 = "com.oculus.assistant.ACTION_SYSTEM_ATTENTION_LISTENER"
            boolean r0 = r0.equals(r1)
            if (r0 == 0) goto L_0x0013
            com.facebook.assistant.clientplatform.logger.AssistantLogger r1 = X.C00799i.A00
            java.lang.String r0 = "attention_system_unbind"
            goto L_0x0010
        */
        throw new UnsupportedOperationException("Method not decompiled: com.oculus.assistant.service.AssistantService.onUnbind(android.content.Intent):boolean");
    }

    public static synchronized void A08(AssistantService assistantService) {
        synchronized (assistantService) {
            Tracer.A01("createAssistantClientPlatform");
            try {
                if (assistantService.A0Q != null && assistantService.A05 == null) {
                    SafeInitializationManager safeInitializationManager = assistantService.A1E;
                    if (!safeInitializationManager.mIsStarted.get()) {
                        C0139Dd.A0F("AssistantService", "Setting up ACP.  StartReason: %s", assistantService.A0T.toString());
                        safeInitializationManager.setIsStarted(true);
                        String A002 = new C1398yc().A00();
                        yZ yZVar = yZ.A03;
                        if (yZVar == null) {
                            yZVar = new yZ();
                            yZ.A03 = yZVar;
                        }
                        yZVar.A00 = assistantService.A0Q;
                        KJ.A05("fbjni", 0);
                        SharedPreferences defaultSharedPreferences = PreferenceManager.getDefaultSharedPreferences(assistantService.getApplicationContext());
                        if (!defaultSharedPreferences.contains("audiologging")) {
                            defaultSharedPreferences.edit().putBoolean("audiologging", false).apply();
                        }
                        Integer num = AnonymousClass09.A00;
                        String string = defaultSharedPreferences.getString("overrideServerEndpoint", AnonymousClass8T.A00(num));
                        if (!string.equals("PRODUCTION")) {
                            if (string.equals("STAGING")) {
                                num = AnonymousClass09.A01;
                            } else if (string.equals("LOCAL")) {
                                num = AnonymousClass09.A0C;
                            } else if (string.equals("INTERNAL")) {
                                num = AnonymousClass09.A0J;
                            } else {
                                throw new IllegalArgumentException(string);
                            }
                        }
                        switch (num.intValue()) {
                            case 1:
                                C0139Dd.A09("AssistantService", "Using staging endpoint for Assistant.");
                                AnonymousClass8P r1 = assistantService.A06;
                                r1.A0D = "https://staging.facebookvirtualassistant.com";
                                r1.A0H = "wss://staging.facebookvirtualassistant.com/v2/vp/recognition";
                                break;
                            case 2:
                                C0139Dd.A09("AssistantService", "Using local endpoint for Assistant.");
                                AnonymousClass8P r12 = assistantService.A06;
                                r12.A0D = "http://localhost:8086";
                                r12.A0E = "localhost";
                                r12.A0H = "ws://localhost:8080/v2/vp/recognition";
                                break;
                            case 3:
                                C0139Dd.A09("AssistantService", "Using internal endpoint for Assistant.");
                                AnonymousClass8P r13 = assistantService.A06;
                                r13.A0D = "https://internal.facebookvirtualassistant.com";
                                r13.A0H = "wss://internal.facebookvirtualassistant.com/v2/vp/recognition";
                                break;
                        }
                        String string2 = defaultSharedPreferences.getString("voice_interaction_endpoint", null);
                        String string3 = defaultSharedPreferences.getString("custom_headers", null);
                        defaultSharedPreferences.getString("transcription_endpoint", null);
                        boolean z = defaultSharedPreferences.getBoolean("use_override_endpoint", false);
                        defaultSharedPreferences.getBoolean("use_override_transcription_endpoint", false);
                        AnonymousClass8P r6 = assistantService.A06;
                        r6.A0B = "oculus";
                        r6.A0G = YS.A00();
                        AnonymousClass8P r62 = assistantService.A06;
                        r62.A00 = 14400;
                        r62.A08 = A002;
                        r62.A0F = "assistant_oculus";
                        r62.A05 = new C1382yJ();
                        r62.A09 = Build.SERIAL;
                        r62.A0J = false;
                        r62.A03 = BJ.OCULUS;
                        r62.A0C = "hey facebook";
                        r62.A0K = true;
                        if (string2 != null && !string2.isEmpty() && z) {
                            r62.A0H = string2;
                        }
                        if (string3 != null) {
                            for (String str : string3.split(";")) {
                                String[] split = str.split(",");
                                if (split.length == 2) {
                                    assistantService.A06.A0I.put(split[0], split[1]);
                                }
                            }
                        }
                        assistantService.A06.A04 = BM.A00;
                        assistantService.A0r.post(new RunnableC0424Xb(assistantService));
                        Application application = assistantService.getApplication();
                        w1 w1Var = assistantService.A0Q;
                        AnonymousClass8P r10 = assistantService.A06;
                        C1383yK yKVar = assistantService.A0Z;
                        C0514bB.A02(C0647dr.A00, "settings");
                        C0740gP gPVar = new C0740gP(application, w1Var, r10, yKVar, yKVar, new AnonymousClass8R(new C0648ds(assistantService, new Object() {
                            /* class com.oculus.assistant.service.AssistantService.AnonymousClass8 */

                            public String getUserId() {
                                return AssistantService.this.A0Q.A00().mUserId;
                            }
                        })));
                        assistantService.A05 = gPVar;
                        C0434Xm xm = new C0434Xm(gPVar.A09("OculusAssistantService", null), assistantService.A0Y, assistantService.A0Q, assistantService.A0e);
                        assistantService.A0u = xm;
                        AnonymousClass8J r8 = xm.A00;
                        AnonymousClass8I r7 = new AnonymousClass8I(r8);
                        try {
                            ArrayList arrayList = new ArrayList();
                            AnonymousClass8E r102 = new AnonymousClass8E();
                            r102.A03 = "88db5726-1642-4c33-b024-3b3686cc35c9";
                            r102.A01 = new AnonymousClass3I(xm.A02);
                            arrayList.add(r102.A00());
                            AnonymousClass8E r14 = new AnonymousClass8E();
                            r14.A01 = new AnonymousClass3L();
                            r14.A03 = "a49360e2-8b98-4ca7-90d5-a6e1e2716d79";
                            arrayList.add(r14.A00());
                            AnonymousClass8E r15 = new AnonymousClass8E();
                            r15.A01 = C1322xG.A00;
                            r15.A03 = "258348302164285";
                            arrayList.add(r15.A00());
                            AnonymousClass8E r16 = new AnonymousClass8E();
                            r16.A01 = C1315x9.A00;
                            r16.A03 = "640899223436448";
                            arrayList.add(r16.A00());
                            AnonymousClass8E r17 = new AnonymousClass8E();
                            r17.A01 = C1320xE.A00;
                            r17.A03 = "354477778854005";
                            arrayList.add(r17.A00());
                            AnonymousClass8E r18 = new AnonymousClass8E();
                            r18.A01 = C1316xA.A00;
                            r18.A03 = "441610320163483";
                            arrayList.add(r18.A00());
                            AnonymousClass8E r19 = new AnonymousClass8E();
                            r19.A01 = new AnonymousClass3Y();
                            r19.A03 = "b1843c7c-b1af-478c-9b7d-96fd7be35b46";
                            arrayList.add(r19.A00());
                            AnonymousClass8E r110 = new AnonymousClass8E();
                            r110.A03 = "50a0ed91-3978-41db-908d-e0f211a097bf";
                            r110.A01 = new AnonymousClass3K();
                            arrayList.add(r110.A00());
                            AnonymousClass8E r111 = new AnonymousClass8E();
                            r111.A03 = "1ea3de7d-e17a-460c-9a44-6079cfc4614f";
                            r111.A01 = new C00333y();
                            arrayList.add(r111.A00());
                            AnonymousClass8E r112 = new AnonymousClass8E();
                            r112.A03 = "ec99de96-9392-4b55-999c-1494b73a8530";
                            r112.A01 = new AnonymousClass3R();
                            arrayList.add(r112.A00());
                            AnonymousClass8E r113 = new AnonymousClass8E();
                            r113.A03 = "df5599f2-55ed-413e-a491-9a41a163df77";
                            r113.A01 = new AnonymousClass6X();
                            arrayList.add(r113.A00());
                            AnonymousClass8E r114 = new AnonymousClass8E();
                            r114.A03 = "cf5f9663-bf20-4e47-a145-63e7942669a5";
                            r114.A01 = new AnonymousClass3H();
                            arrayList.add(r114.A00());
                            AnonymousClass8E r115 = new AnonymousClass8E();
                            r115.A03 = "88c90a40-414a-4382-b076-2920a317c30b";
                            r115.A01 = new AnonymousClass3G();
                            arrayList.add(r115.A00());
                            AnonymousClass8E r116 = new AnonymousClass8E();
                            r116.A03 = "840f6c59-0691-482a-965c-fa733fde7877";
                            r116.A01 = new C1317xB(xm);
                            arrayList.add(r116.A00());
                            AnonymousClass8E r117 = new AnonymousClass8E();
                            r117.A03 = "0d1089bc-c08c-4c27-916f-6618a93922c3";
                            r117.A01 = new AnonymousClass6A();
                            arrayList.add(r117.A00());
                            AnonymousClass8E r118 = new AnonymousClass8E();
                            r118.A03 = "42ab2c51-0538-492e-adac-b15a987a7e69";
                            r118.A01 = new AnonymousClass7q();
                            arrayList.add(r118.A00());
                            AnonymousClass8E r119 = new AnonymousClass8E();
                            r119.A03 = "7396d7cc-1647-465b-af33-bf21cc1b8b8f";
                            r119.A01 = new C00426r();
                            arrayList.add(r119.A00());
                            if (BX.A00().checkPermission("android.permission.SHUTDOWN", Process.myPid(), Process.myUid()) == 0) {
                                AnonymousClass8E r120 = new AnonymousClass8E();
                                r120.A03 = "6af6dccc-e266-4322-8860-e98529ce855d";
                                r120.A01 = new AnonymousClass3T();
                                arrayList.add(r120.A00());
                            }
                            AnonymousClass8E r121 = new AnonymousClass8E();
                            r121.A03 = "5af9ecb7-4e95-4a93-9ad4-7f198f7854ef";
                            r121.A01 = new C00233b();
                            arrayList.add(r121.A00());
                            AnonymousClass8E r122 = new AnonymousClass8E();
                            r122.A03 = "1ff60e57-9f2b-42ea-bdaa-6b49c6d72a71";
                            r122.A01 = new AnonymousClass6B();
                            arrayList.add(r122.A00());
                            AnonymousClass8E r123 = new AnonymousClass8E();
                            r123.A03 = "2afc22ab-72b3-4641-8039-902f36a40ca6";
                            r123.A01 = new C00366h();
                            arrayList.add(r123.A00());
                            AnonymousClass8E r124 = new AnonymousClass8E();
                            r124.A03 = "3594416710615335";
                            r124.A01 = new AnonymousClass3z();
                            arrayList.add(r124.A00());
                            AnonymousClass8E r125 = new AnonymousClass8E();
                            r125.A03 = "6c400ddb-b595-4801-95c6-18fc055e76ba";
                            r125.A01 = new AnonymousClass41();
                            arrayList.add(r125.A00());
                            AnonymousClass8E r126 = new AnonymousClass8E();
                            r126.A03 = "CAPTURE_VIDEO_END";
                            r126.A01 = new AnonymousClass41();
                            arrayList.add(r126.A00());
                            AnonymousClass8E r127 = new AnonymousClass8E();
                            r127.A03 = "7478bf91-0286-4203-b9d6-945df3795f1b";
                            r127.A01 = new C00243c();
                            arrayList.add(r127.A00());
                            AnonymousClass8E r128 = new AnonymousClass8E();
                            r128.A03 = "b2fbc5d4-7f9c-4493-8832-edb6e8a7e017";
                            r128.A01 = new C00253d();
                            arrayList.add(r128.A00());
                            AnonymousClass8E r129 = new AnonymousClass8E();
                            r129.A03 = "2687e26d-948f-491a-b695-25db141af8df";
                            r129.A01 = new C00263e();
                            arrayList.add(r129.A00());
                            AnonymousClass8E r130 = new AnonymousClass8E();
                            r130.A03 = "e524f2a3-e633-4af7-af99-1e13cbe03cd3";
                            r130.A01 = new AnonymousClass42();
                            arrayList.add(r130.A00());
                            AnonymousClass8E r103 = new AnonymousClass8E();
                            r103.A03 = "fcefce43-d121-47de-939d-1f1f624c761d";
                            r103.A01 = new AnonymousClass6g(new C1324xI(xm));
                            arrayList.add(r103.A00());
                            AnonymousClass8E r131 = new AnonymousClass8E();
                            r131.A03 = "199159504696292";
                            r131.A01 = new AnonymousClass3M();
                            arrayList.add(r131.A00());
                            AnonymousClass8E r132 = new AnonymousClass8E();
                            r132.A03 = "70681111-7232-4722-8b96-cd0fbb3a97e1";
                            r132.A01 = new C00456u();
                            arrayList.add(r132.A00());
                            AnonymousClass8E r133 = new AnonymousClass8E();
                            r133.A03 = "949942572167148";
                            r133.A01 = new C00476w();
                            arrayList.add(r133.A00());
                            AnonymousClass8E r134 = new AnonymousClass8E();
                            r134.A03 = "f92b841a-e8b3-4f2d-91d4-3c29ef88c2cb";
                            r134.A01 = xm.A01;
                            arrayList.add(r134.A00());
                            AnonymousClass8E r135 = new AnonymousClass8E();
                            r135.A03 = "73856422-4e0d-4219-bd0a-7b78a7369c53";
                            r135.A01 = new C1326xK(xm);
                            arrayList.add(r135.A00());
                            AnonymousClass8E r136 = new AnonymousClass8E();
                            r136.A03 = "973a1c33-d73f-4b94-afb2-41356f0d742f";
                            r136.A01 = new C1314x8(xm);
                            arrayList.add(r136.A00());
                            if (BX.A00().checkPermission("android.permission.REBOOT", Process.myPid(), Process.myUid()) == 0) {
                                AnonymousClass8E r137 = new AnonymousClass8E();
                                r137.A03 = "0d6ea253-f2eb-4a5a-8104-908455f3269f";
                                r137.A01 = C1312x6.A00;
                                arrayList.add(r137.A00());
                            }
                            if (BX.A00().checkPermission("android.permission.DEVICE_POWER", Process.myPid(), Process.myUid()) == 0) {
                                AnonymousClass8E r138 = new AnonymousClass8E();
                                r138.A03 = "1593b028-a569-4a58-8fda-46eaac0b8cd5";
                                r138.A01 = new AnonymousClass3J();
                                arrayList.add(r138.A00());
                            }
                            if (W0.A00().A00.getBoolean("is_allowed_debugusersettings", false)) {
                                AnonymousClass8E r104 = new AnonymousClass8E();
                                r104.A01("open a timer");
                                r104.A03 = "set-a-timer";
                                r104.A01 = new C1407yt();
                                arrayList.add(r104.A00());
                                AnonymousClass8E r105 = new AnonymousClass8E();
                                r105.A01("cancel timer");
                                r105.A03 = "cancel-timer";
                                r105.A01 = new C1404yq();
                                arrayList.add(r105.A00());
                            }
                            if (W0.A00().A00.getBoolean("is_allowed_usersettings", false)) {
                                Application A003 = BX.A00();
                                PackageManager packageManager = A003.getPackageManager();
                                packageManager.setComponentEnabledSetting(new ComponentName(A003.getPackageName(), "com.oculus.assistant.testui.AssistantTestActivity"), 1, 1);
                                packageManager.setComponentEnabledSetting(new ComponentName(A003.getPackageName(), "com.oculus.assistant.testui.AssistantTypeaheadTestActivity"), 1, 1);
                                AnonymousClass8E r106 = new AnonymousClass8E();
                                r106.A03 = "assistant_debug";
                                r106.A01("show assistant settings");
                                r106.A01 = C1327xL.A00;
                                arrayList.add(r106.A00());
                                AnonymousClass8E r107 = new AnonymousClass8E();
                                r107.A03 = "assistant_typeahead_debug";
                                r107.A01("show assistant keyboard settings");
                                r107.A01 = C1319xD.A00;
                                arrayList.add(r107.A00());
                                AnonymousClass8E r108 = new AnonymousClass8E();
                                r108.A03 = "enable_qa_mode";
                                r108.A01("enable testing mode");
                                r108.A01 = new C1325xJ(xm);
                                arrayList.add(r108.A00());
                                AnonymousClass8E r109 = new AnonymousClass8E();
                                r109.A03 = "disable_qa_mode";
                                r109.A01("disable testing mode");
                                r109.A01 = new C1323xH(xm);
                                arrayList.add(r109.A00());
                                AnonymousClass8E r1010 = new AnonymousClass8E();
                                r1010.A03 = "restart_nux";
                                r1010.A01("reset new user experience");
                                r1010.A01 = new C1311x5(xm);
                                arrayList.add(r1010.A00());
                                AnonymousClass8E r1011 = new AnonymousClass8E();
                                r1011.A03 = "fitness_overlay_enable";
                                r1011.A01("enable fitness overlay");
                                r1011.A01("enable fitness tracker overlay");
                                r1011.A01("enable fitness tracking overlay");
                                r1011.A01("enable move overlay");
                                r1011.A01("show fitness overlay");
                                r1011.A01("show fitness tracker overlay");
                                r1011.A01("show fitness tracking overlay");
                                r1011.A01("show move overlay");
                                r1011.A01("turn on fitness overlay");
                                r1011.A01("turn on fitness tracker overlay");
                                r1011.A01("turn on fitness tracking overlay");
                                r1011.A01("turn on move overlay");
                                r1011.A01 = new C1318xC(xm);
                                arrayList.add(r1011.A00());
                                AnonymousClass8E r1012 = new AnonymousClass8E();
                                r1012.A03 = "fitness_overlay_disable";
                                r1012.A01("disable fitness overlay");
                                r1012.A01("disable fitness tracker overlay");
                                r1012.A01("disable fitness tracking overlay");
                                r1012.A01("disable move overlay");
                                r1012.A01("hide fitness overlay");
                                r1012.A01("hide fitness tracker overlay");
                                r1012.A01("hide fitness tracking overlay");
                                r1012.A01("hide move overlay");
                                r1012.A01("turn off fitness overlay");
                                r1012.A01("turn off fitness tracker overlay");
                                r1012.A01("turn off fitness tracking overlay");
                                r1012.A01("turn off move overlay");
                                r1012.A01 = new C1310x4(xm);
                                arrayList.add(r1012.A00());
                                if (W0.A00().A00.getBoolean("is_allowed_debugusersettings", false)) {
                                    AnonymousClass8E r139 = new AnonymousClass8E();
                                    r139.A03 = "choose_voice";
                                    r139.A01("change voice");
                                    r139.A01("choose voice");
                                    r139.A01("select voice");
                                    r139.A01 = C1313x7.A00;
                                    arrayList.add(r139.A00());
                                }
                            }
                            r8.A03(arrayList);
                            synchronized (r8) {
                                r8.A05 = true;
                                AnonymousClass8J.A00(r8);
                            }
                            r7.close();
                            assistantService.A0Z.A00 = assistantService.A05.A09("OculusAssistantService", null);
                            YM ym = new YM(assistantService.A05);
                            assistantService.A0y = ym;
                            C0112Aq aq = ym.A07;
                            aq.A02(C1220va.class, ym.A01);
                            aq.A02(C1222vc.class, ym.A02);
                            aq.A02(C1223vd.class, ym.A05);
                            aq.A02(C1224ve.class, ym.A06);
                            aq.A02(C1255wB.class, ym.A04);
                            aq.A02(C1260wG.class, ym.A03);
                            OculusTypeaheadProvider oculusTypeaheadProvider = new OculusTypeaheadProvider(assistantService.getApplicationContext(), YS.A00(), assistantService.getCacheDir().getAbsolutePath(), assistantService.A01());
                            assistantService.A0z = oculusTypeaheadProvider;
                            oculusTypeaheadProvider.A04 = new C1417z8(oculusTypeaheadProvider);
                            oculusTypeaheadProvider.A03 = new z9(oculusTypeaheadProvider);
                            C1418zA zAVar = new C1418zA(oculusTypeaheadProvider);
                            oculusTypeaheadProvider.A05 = zAVar;
                            oculusTypeaheadProvider.A06.A02(C0776h5.class, zAVar);
                            oculusTypeaheadProvider.A06.A02(C1255wB.class, oculusTypeaheadProvider.A04);
                            oculusTypeaheadProvider.A06.A02(C1260wG.class, oculusTypeaheadProvider.A03);
                            Y4 y4 = new Y4(assistantService.A05.A0A(), assistantService.A0a);
                            assistantService.A0X = y4;
                            C0112Aq aq2 = y4.A0A;
                            aq2.A02(C1255wB.class, y4.A07);
                            aq2.A02(C1260wG.class, y4.A09);
                            aq2.A02(C0809hx.class, y4.A06);
                            aq2.A02(C0811hz.class, y4.A08);
                            aq2.A02(C0806hu.class, y4.A04);
                            aq2.A02(C0808hw.class, y4.A05);
                            aq2.A02(C1204vJ.class, y4.A03);
                            Y2 y2 = new Y2(new C0446Yq(assistantService.A0Q, assistantService.A0r, true));
                            assistantService.A0v = y2;
                            C0112Aq aq3 = y2.A05;
                            aq3.A02(C1255wB.class, y2.A00);
                            aq3.A02(C1260wG.class, y2.A04);
                            aq3.A02(i0.class, y2.A01);
                            aq3.A02(C1202vH.class, y2.A02);
                            aq3.A02(C1203vI.class, y2.A03);
                            YJ yj = new YJ(new C0446Yq(assistantService.A0Q, assistantService.A0r, false));
                            assistantService.A0x = yj;
                            C0112Aq aq4 = yj.A04;
                            aq4.A02(C1255wB.class, yj.A00);
                            aq4.A02(C1260wG.class, yj.A03);
                            aq4.A02(vR.class, yj.A01);
                            aq4.A02(C1213vT.class, yj.A02);
                            if ((assistantService.A0T == StartReason.VOICE_COMMANDS && A0F(assistantService)) || (assistantService.A0T == StartReason.TRANSCRIPTION && assistantService.A0D())) {
                                assistantService.A05.A0C();
                            }
                            C0740gP gPVar2 = assistantService.A05;
                            gPVar2.A0B();
                            gPVar2.A0O.A3e();
                            C0112Aq aq5 = gPVar2.A0h;
                            aq5.A03(C0799hn.class, gPVar2.A0P);
                            aq5.A02(C0800ho.class, gPVar2.A0Q);
                            aq5.A03(i1.class, gPVar2.A0g);
                            aq5.A02(C0801hp.class, gPVar2.A0W);
                            aq5.A03(hS.class, gPVar2.A0Y);
                            aq5.A02(hU.class, gPVar2.A0R);
                            aq5.A02(C0787ha.class, gPVar2.A0V);
                            aq5.A02(hY.class, gPVar2.A0T);
                            aq5.A02(hZ.class, gPVar2.A0U);
                            aq5.A02(hX.class, gPVar2.A0S);
                            aq5.A02(hT.class, gPVar2.A0X);
                            aq5.A03(iF.class, gPVar2.A0Z);
                            aq5.A03(C0824iU.class, gPVar2.A0c);
                            gPVar2.A0K.A3e();
                            assistantService.A18.A01(new C1254wA());
                            safeInitializationManager.setIsReady(true);
                            YP yp = assistantService.A0a;
                            C0139Dd.A09("OculusAssistantInteractionLatencyLogger", "endStartup");
                            YO yo = yp.A01;
                            if (yo != null) {
                                yo.A01.markerPoint(yo.A00(), "startup_end");
                            }
                            yp.A00.markerEnd(50790403, 2);
                        } catch (Throwable unused) {
                        }
                    }
                }
            } finally {
                Tracer.A00();
            }
        }
        return;
        throw th;
    }
}
