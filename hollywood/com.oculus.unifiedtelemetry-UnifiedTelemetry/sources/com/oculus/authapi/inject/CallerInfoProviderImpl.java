package com.oculus.authapi.inject;

import X.AbstractC0096Hu;
import X.AbstractC0247Xu;
import X.C0383gh;
import X.C0422hY;
import X.C0515sp;
import X.QC;
import android.app.PendingIntent;
import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.os.Bundle;
import android.os.SystemClock;
import android.util.Base64;
import com.facebook.acra.LogCatCollector;
import com.facebook.ultralight.AutoGeneratedAccessMethod;
import com.facebook.ultralight.AutoGeneratedFactoryMethod;
import com.facebook.ultralight.Dependencies;
import com.facebook.ultralight.Inject;
import com.oculus.authapi.OVRAuth;
import org.json.JSONException;
import org.json.JSONObject;

@Dependencies({"_UL__ULSEP_android_content_Context_ULSEP_com_facebook_inject_ForAppContext_ULSEP_BINDING_ID"})
public class CallerInfoProviderImpl implements OVRAuth.CallerInfoProvider {
    public QC _UL_mInjectionContext;

    @Override // com.oculus.authapi.OVRAuth.CallerInfoProvider
    public final Intent A1I(Intent intent) {
        String str;
        try {
            Context context = (Context) AbstractC0096Hu.A03(0, 3, this._UL_mInjectionContext);
            String str2 = null;
            try {
                intent.setExtrasClassLoader(context.getClassLoader());
                Bundle extras = intent.getExtras();
                if (extras == null) {
                    extras = new Bundle();
                }
                extras.setClassLoader(context.getClassLoader());
                try {
                    str = context.getPackageManager().getPackageInfo(context.getPackageName(), 0).versionName;
                } catch (PackageManager.NameNotFoundException | RuntimeException unused) {
                    str = null;
                }
                long currentTimeMillis = System.currentTimeMillis();
                long elapsedRealtime = SystemClock.elapsedRealtime();
                JSONObject jSONObject = new JSONObject();
                try {
                    jSONObject.put("t", Long.toString(currentTimeMillis));
                    jSONObject.put("r", Long.toString(elapsedRealtime));
                    if (str != null) {
                        jSONObject.put("v", str);
                    }
                    str2 = Base64.encodeToString(jSONObject.toString().getBytes(LogCatCollector.UTF_8_ENCODING), 11);
                } catch (JSONException unused2) {
                }
                C0383gh ghVar = new C0383gh();
                ghVar.A07 = str2;
                ghVar.A02 = new ComponentName(context, "com.facebook.invalid_class.f4c3b00c");
                Intent intent2 = new Intent();
                intent2.setComponent(ghVar.A02);
                intent2.setFlags(ghVar.A00);
                intent2.setAction(ghVar.A07);
                intent2.setDataAndType(ghVar.A05, ghVar.A08);
                intent2.setSourceBounds(ghVar.A04);
                intent2.setSelector(ghVar.A03);
                intent2.setClipData(ghVar.A01);
                for (String str3 : ghVar.A09) {
                    intent2.addCategory(str3);
                }
                if (ghVar.A06 != null) {
                    intent2.setExtrasClassLoader(context.getClassLoader());
                    intent2.putExtras(ghVar.A06);
                }
                if (intent2.getComponent() != null) {
                    intent2.setPackage(intent2.getComponent().getPackageName());
                    extras.putParcelable("_ci_", PendingIntent.getActivity(context, 0, intent2, 1140850688));
                    intent.putExtras(extras);
                    return intent;
                }
                throw new SecurityException("Must generate PendingIntent based on an explicit intent.");
            } catch (Exception e) {
                throw new C0422hY(e);
            }
        } catch (C0422hY e2) {
            throw new RuntimeException(e2);
        }
    }

    @AutoGeneratedAccessMethod
    public static final CallerInfoProviderImpl A00(AbstractC0247Xu xu) {
        return (CallerInfoProviderImpl) C0515sp.A00(96, xu);
    }

    @AutoGeneratedFactoryMethod
    public static final CallerInfoProviderImpl A01(AbstractC0247Xu xu) {
        return new CallerInfoProviderImpl(xu);
    }

    @Inject
    public CallerInfoProviderImpl(AbstractC0247Xu xu) {
        this._UL_mInjectionContext = new QC(1, xu);
    }
}
