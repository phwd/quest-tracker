package com.oculus.alpenglow.crashreporting;

import X.AbstractC02990bJ;
import X.AnonymousClass0Lh;
import X.AnonymousClass0Qe;
import X.AnonymousClass0R7;
import com.facebook.inject.ApplicationScoped;
import com.facebook.ultralight.AutoGeneratedFactoryMethod;
import com.facebook.ultralight.Dependencies;
import com.facebook.ultralight.Inject;
import com.oculus.alpenglow.config.ConfigChangeListener;
import com.oculus.alpenglow.config.Device;
import com.oculus.alpenglow.graphql.enums.GraphQLHWMOculusOSCrashReportingState;
import com.oculus.os.SettingsManager;

@Dependencies({"_UL__ULSEP_com_oculus_os_SettingsManager_ULSEP_BINDING_ID"})
@ApplicationScoped
public class CrashReportingConfigChangeListener implements ConfigChangeListener {
    public static final String TAG = "EnterpriseServer.CrashReportingConfigChangeListener";
    public static volatile CrashReportingConfigChangeListener _UL__ULSEP_com_oculus_alpenglow_crashreporting_CrashReportingConfigChangeListener_ULSEP_INSTANCE;
    public AnonymousClass0R7 _UL_mInjectionContext;

    @Override // com.oculus.alpenglow.config.ConfigChangeListener
    public final void A5z(Device device, Device device2) {
        Device.ManagementInfo.DeviceConfig.OsConfig osConfig;
        GraphQLHWMOculusOSCrashReportingState graphQLHWMOculusOSCrashReportingState;
        GraphQLHWMOculusOSCrashReportingState graphQLHWMOculusOSCrashReportingState2;
        Device.ManagementInfo A3y;
        Device.ManagementInfo.DeviceConfig A3Q;
        Device.ManagementInfo A3y2;
        Device.ManagementInfo.DeviceConfig A3Q2;
        Device.ManagementInfo.DeviceConfig.OsConfig osConfig2 = null;
        if (device2 == null || (A3y2 = device2.A3y()) == null || (A3Q2 = A3y2.A3Q()) == null) {
            osConfig = null;
        } else {
            osConfig = A3Q2.A4D();
        }
        if (!(device == null || (A3y = device.A3y()) == null || (A3Q = A3y.A3Q()) == null)) {
            osConfig2 = A3Q.A4D();
        }
        if (osConfig == null || (graphQLHWMOculusOSCrashReportingState = osConfig.A3G()) == null) {
            graphQLHWMOculusOSCrashReportingState = GraphQLHWMOculusOSCrashReportingState.ON;
        }
        if (osConfig2 == null || (graphQLHWMOculusOSCrashReportingState2 = osConfig2.A3G()) == null) {
            graphQLHWMOculusOSCrashReportingState2 = GraphQLHWMOculusOSCrashReportingState.ON;
        }
        if (graphQLHWMOculusOSCrashReportingState != graphQLHWMOculusOSCrashReportingState2) {
            boolean z = false;
            SettingsManager settingsManager = (SettingsManager) AnonymousClass0Lh.A03(0, 105, this._UL_mInjectionContext);
            if (graphQLHWMOculusOSCrashReportingState != GraphQLHWMOculusOSCrashReportingState.OFF) {
                z = true;
            }
            settingsManager.setBoolean("crash_reports_enabled", z);
        }
    }

    @AutoGeneratedFactoryMethod
    public static final CrashReportingConfigChangeListener A00(AbstractC02990bJ r4) {
        if (_UL__ULSEP_com_oculus_alpenglow_crashreporting_CrashReportingConfigChangeListener_ULSEP_INSTANCE == null) {
            synchronized (CrashReportingConfigChangeListener.class) {
                AnonymousClass0Qe A00 = AnonymousClass0Qe.A00(_UL__ULSEP_com_oculus_alpenglow_crashreporting_CrashReportingConfigChangeListener_ULSEP_INSTANCE, r4);
                if (A00 != null) {
                    try {
                        _UL__ULSEP_com_oculus_alpenglow_crashreporting_CrashReportingConfigChangeListener_ULSEP_INSTANCE = new CrashReportingConfigChangeListener(r4.getApplicationInjector());
                    } finally {
                        A00.A01();
                    }
                }
            }
        }
        return _UL__ULSEP_com_oculus_alpenglow_crashreporting_CrashReportingConfigChangeListener_ULSEP_INSTANCE;
    }

    @Inject
    public CrashReportingConfigChangeListener(AbstractC02990bJ r3) {
        this._UL_mInjectionContext = new AnonymousClass0R7(1, r3);
    }
}
